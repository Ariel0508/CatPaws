import{N as D,P as U,S as N,a as j}from"./pagination-hurwVTjr.js";import{M as F,K as Q}from"./mousewheel-M_5C9zab.js";import{_ as H,k as K,l as O,f as y,s as z,g as G,r as f,o as n,c as a,a as t,F as M,m as S,t as r,b as m,w as v,d as x,y as J,A as W,j as $,p as X,q as Y}from"./index-chrp63HQ.js";import{a as b}from"./axios-G2rPRu76.js";import{u as Z}from"./cartStore-4VNCE_vT.js";import{u as tt}from"./toastMessage-jeIKEn4C.js";import{C as et}from"./CouponModal-ILAWz4Dq.js";import{_ as ot}from"./ToastMessages-A2Jk37eF.js";const st="/week8/assets/empty-cart-Cdy4DvIF.png";var nt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const at={setup(){const{VITE_APP_URL:_,VITE_APP_PATH:u}=nt,I=K(),s=O(),P=Z(),T=tt(),{pushMessage:d}=T,{getCart:h}=P,C=y([]),k=y(s.params.productId),g=y({}),e=y({loadingItem:""}),l=()=>{const{category:o=""}=s.query,i=`${_}/api/${u}/products?category=${o}`;b.get(i).then(c=>{C.value=c.data.products,console.log(c.data.products)})},V=o=>{I.push(`/product/${o.id}`).then(()=>{window.scrollTo(0,0)})},q=y(null),w=()=>{const o=`${_}/api/${u}/cart`;b.get(o).then(i=>{g.value=i.data.data})},L=(o,i=1)=>{const c={product_id:o.product_id,qty:i};e.value.loadingItem=o.id;const p=`${_}/api/${u}/cart/${o.id}`;b.put(p,{data:c}).then(()=>{e.value.loadingItem="",w()})},R=()=>{q.value.oModal()},A=o=>{e.value.loadingItem=o;const i={product_id:o,qty:1},c=`${_}/api/${u}/cart`;b.post(c,{data:i}).then(p=>{e.value.loadingItem="",d({style:"success",title:"加入購物車",content:p.data.message}),h()})},B=o=>{e.value.loadingItem=o;const i=`${_}/api/${u}/cart/${o}`;b.delete(i).then(c=>{e.value.loadingItem="",d({style:"success",title:"刪除成功",content:c.data.message}),h(),w()})},E=o=>{const i=`${_}/api/${u}/cart/${o.id}`,c={product_id:o.product_id,qty:o.qty};b.put(i,{data:c}).then(p=>{d({style:"success",title:"更新購物車",content:p.data.message}),h()}).catch(p=>{d({style:"danger",title:"更新購物車",content:p.response.data.message})})};return z(()=>g.value,()=>{w()}),G(()=>{h(),w(),l()}),{modules:[D,U,F,Q],products:C,id:k,openModal:V,carts:g,status:e,changeCartQty:L,CouponModalRef:q,openCouponModal:R,removeCartItem:B,addToCart:A,getProducts:l,getCartList:w,updateCart:E}},components:{Swiper:N,SwiperSlide:j,CouponModaL:et,ToastMessages:ot}},it=t("div",{class:"container mt-8 p-0"},[t("nav",{"aria-label":"breadcrumb"},[t("ol",{class:"breadcrumb"},[t("li",{class:"breadcrumb-item active","aria-current":"page"},"購物車")])])],-1),lt={class:"container mt-5"},ct={class:"row"},dt={key:0,class:"table align-middle border-lightBrown"},rt=t("thead",null,[t("tr",null,[t("th",{width:"5%"}),t("th",{width:"35%"},"商品名稱"),t("th",{width:"20%"},"單價"),t("th",{width:"30%"},"數量"),t("th",{width:"20%"},"小計"),t("th",{width:"20%"},"刪除")])],-1),_t=t("td",null,null,-1),ut=["src"],pt={class:"input-group w-100"},ht=["disabled","onClick"],mt=t("span",{style:{height:"16px",width:"16px"}},"-",-1),bt=[mt],gt=["onClick"],wt=t("span",{style:{height:"16px",width:"16px"}},[t("i",{class:"bi bi-trash"})],-1),yt=[wt],ft=["onUpdate:modelValue","disabled"],vt=["onClick"],xt=t("span",{style:{height:"16px",width:"16px"}},"+",-1),Ct=[xt],kt=["onClick"],Mt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},$t=t("i",{class:"bi bi-trash"},null,-1),It={class:"border-white"},Pt=t("td",null,null,-1),Tt=t("td",null,null,-1),qt={class:"text-brown fs-5 text-end",colspan:"3"},St={class:"pe-3"},Vt={class:"d-flex justify-content-center align-items-center p-0",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #e9b888"}},Lt={key:1,class:"text-center mb-8"},Rt=t("img",{src:st,class:"img-fluid object-fit-cover w-25",alt:"emptycartpicture"},null,-1),At={class:"text-brown fs-5"},Bt=t("br",null,null,-1),Et={class:"container mt-8 p-0"},Dt=t("h3",{class:"text-center text-brown"},[x(" 猜你喜歡 "),t("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),Ut={id:"swiper"},Nt={class:"col-md-9"},jt=["onClick"],Ft={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},Qt=["src"],Ht={class:"card-body"},Kt={class:"card-title"},Ot={key:0,class:"text-gray2 fs-5 card-title"},zt={key:1,class:"d-flex align-items-center card-title ms-2"},Gt={class:"text-gray2 fs-5"},Jt={class:"text-brown fs-4 ms-3"},Wt=["onClick"],Xt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Yt=t("i",{class:"bi bi-cart-plus"},null,-1);function Zt(_,u,I,s,P,T){const d=f("RouterLink"),h=f("swiper-slide"),C=f("swiper"),k=f("ToastMessages"),g=f("CouponModaL");return n(),a(M,null,[it,t("div",lt,[t("div",ct,[s.carts.total!==0?(n(),a("table",dt,[rt,t("tbody",null,[(n(!0),a(M,null,S(s.carts.carts,e=>(n(),a("tr",{key:e.id},[_t,t("td",null,[t("img",{src:e.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,ut),m(d,{class:"text-decoration-none ps-3 text-black",to:`/product/${e.product.id}`},{default:v(()=>[x(r(e.product.title),1)]),_:2},1032,["to"])]),t("td",null,"$"+r(e.product.price),1),t("td",null,[t("div",pt,[e.qty>1?(n(),a("button",{key:0,type:"button",class:"btn btn-outline-lightBrown",disabled:e.qty===1,onClick:l=>{e.qty--,s.changeCartQty(e,e.qty)}},bt,8,ht)):(n(),a("button",{key:1,type:"button",class:"btn btn-outline-brown border-lightBrown",onClick:l=>s.removeCartItem(e.id)},yt,8,gt)),J(t("input",{"onUpdate:modelValue":l=>e.qty=l,type:"number",min:"1",max:"20",class:"form-control text-center","aria-label":"Dollar amount (with dot and two decimal places)",readonly:"",disabled:e.productId===s.status.loadingItem},null,8,ft),[[W,e.qty]]),t("button",{type:"button",class:"btn btn-outline-lightBrown",onClick:l=>{e.qty++,s.changeCartQty(e,e.qty)}},Ct,8,vt)])]),t("td",null,"$"+r(e.total),1),t("td",null,[t("button",{class:"btn btn-outline-brown border-0",onClick:l=>s.removeCartItem(e.id)},[e.id===s.status.loadingItem?(n(),a("span",Mt)):$("",!0),$t],8,kt)])]))),128))]),t("tfoot",null,[t("tr",It,[Pt,Tt,t("td",qt,"總金額:$"+r(s.carts.final_total)+"元",1),t("td",St,[t("div",Vt,[m(d,{class:"loginbtn text-center bg-brown d-block",to:"/order",onclick:"window.scrollTo(0, 0);"},{default:v(()=>[x("立即結帳")]),_:1})])])])])])):(n(),a("div",Lt,[Rt,t("div",At,[x(" 購物車還沒有商品呦~ "),Bt,m(d,{to:"/products",class:"btn btn-brown text-decoration-none m-3"},{default:v(()=>[x("按我去選購")]),_:1})])]))])]),t("div",Et,[Dt,t("div",Ut,[m(C,{slidesPerView:2,grabCursor:!0,pagination:{clickable:!0},modules:s.modules,class:"mySwiper",navigation:!0,mousewheel:!0,keyboard:!0},{default:v(()=>[(n(!0),a(M,null,S(s.products,e=>(n(),X(h,{key:e.id},{default:v(()=>[t("div",Nt,[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5 col-12 ms-3 p-0",onClick:l=>s.openModal(e)},[e.price!==e.origin_price?(n(),a("span",Ft,"SALE")):$("",!0),t("img",{src:e.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,Qt),t("div",Ht,[t("p",Kt,r(e.title),1),e.price===e.origin_price?(n(),a("div",Ot," $"+r(e.origin_price),1)):(n(),a("div",zt,[t("del",Gt,"$"+r(e.origin_price),1),t("div",Jt,"$"+r(e.price),1)])),t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:Y(l=>s.addToCart(e.id,1),["stop"])},[e.id===s.status.loadingItem?(n(),a("span",Xt)):$("",!0),Yt],8,Wt)])],8,jt)])]),_:2},1024))),128))]),_:1},8,["modules"])])]),m(k),m(g,{ref:"CouponModalRef"},null,512)],64)}const ce=H(at,[["render",Zt]]);export{ce as default};
