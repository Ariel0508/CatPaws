import{a as O}from"./axios-G2rPRu76.js";import{v as F,x as G,u as j,f as c,s as Y,_ as H,o as b,c as y,a as t,y as R,z as B,i as D,F as X,m as U,n as K,k as J,l as Q,g as Z,r as I,b as T,w as A,t as C,A as tt,j as $,d as L,p as et,q as ot}from"./index-jjd0GBJI.js";import{u as st}from"./cartStore-izFotvQE.js";import{u as nt}from"./toastMessage-T-vDHxpX.js";import{_ as at}from"./ToastMessages-LWYl60w5.js";import{P as it,N as lt,S as ct,a as rt}from"./pagination-KvEg6s1V.js";import{M as dt,K as ut}from"./mousewheel-QK0zH6Tp.js";function pt(o){return F()?(G(o),!0):!1}function W(o){return typeof o=="function"?o():j(o)}const mt=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const _t=Object.prototype.toString,vt=o=>_t.call(o)==="[object Object]",ft=()=>{};function N(o){var a;const p=W(o);return(a=p==null?void 0:p.$el)!=null?a:p}const q=mt?window:void 0;function V(...o){let a,p,e,d;if(typeof o[0]=="string"||Array.isArray(o[0])?([p,e,d]=o,a=q):[a,p,e,d]=o,!a)return ft;Array.isArray(p)||(p=[p]),Array.isArray(e)||(e=[e]);const i=[],r=()=>{i.forEach(l=>l()),i.length=0},f=(l,n,_,v)=>(l.addEventListener(n,_,v),()=>l.removeEventListener(n,_,v)),u=Y(()=>[N(a),W(d)],([l,n])=>{if(r(),!l)return;const _=vt(n)?{...n}:n;i.push(...p.flatMap(v=>e.map(g=>f(l,v,g,_))))},{immediate:!0,flush:"post"}),m=()=>{u(),r()};return pt(m),m}const gt={page:o=>[o.pageX,o.pageY],client:o=>[o.clientX,o.clientY],screen:o=>[o.screenX,o.screenY],movement:o=>o instanceof Touch?null:[o.movementX,o.movementY]};function ht(o={}){const{type:a="page",touch:p=!0,resetOnTouchEnds:e=!1,initialValue:d={x:0,y:0},window:i=q,target:r=i,scroll:f=!0,eventFilter:u}=o;let m=null;const l=c(d.x),n=c(d.y),_=c(null),v=typeof a=="function"?a:gt[a],g=s=>{const h=v(s);m=s,h&&([l.value,n.value]=h,_.value="mouse")},w=s=>{if(s.touches.length>0){const h=v(s.touches[0]);h&&([l.value,n.value]=h,_.value="touch")}},x=()=>{if(!m||!i)return;const s=v(m);m instanceof MouseEvent&&s&&(l.value=s[0]+i.scrollX,n.value=s[1]+i.scrollY)},k=()=>{l.value=d.x,n.value=d.y},E=u?s=>u(()=>g(s),{}):s=>g(s),P=u?s=>u(()=>w(s),{}):s=>w(s),M=u?()=>u(()=>x(),{}):()=>x();if(r){const s={passive:!0};V(r,["mousemove","dragover"],E,s),p&&a!=="movement"&&(V(r,["touchstart","touchmove"],P,s),e&&V(r,"touchend",k,s)),f&&a==="page"&&V(i,"scroll",M,{passive:!0})}return{x:l,y:n,sourceType:_}}function bt(o,a={}){const{handleOutside:p=!0,window:e=q}=a,d=a.type||"page",{x:i,y:r,sourceType:f}=ht(a),u=c(o??(e==null?void 0:e.document.body)),m=c(0),l=c(0),n=c(0),_=c(0),v=c(0),g=c(0),w=c(!0);let x=()=>{};return e&&(x=Y([u,i,r],()=>{const k=N(u);if(!k)return;const{left:E,top:P,width:M,height:s}=k.getBoundingClientRect();n.value=E+(d==="page"?e.pageXOffset:0),_.value=P+(d==="page"?e.pageYOffset:0),v.value=s,g.value=M;const h=i.value-n.value,S=r.value-_.value;w.value=M===0||s===0||h<0||S<0||h>M||S>s,(p||!w.value)&&(m.value=h,l.value=S)},{immediate:!0}),V(document,"mouseleave",()=>{w.value=!0})),{x:i,y:r,sourceType:f,elementX:m,elementY:l,elementPositionX:n,elementPositionY:_,elementHeight:v,elementWidth:g,isOutside:w,stop:x}}const yt={class:"goods-image p-0"},wt=["src"],xt={class:"small"},kt=["onMouseenter"],Ct=["src"],Pt={__name:"ImageComponentView",props:{imageList:{type:Array,default:()=>[]}},setup(o){const a=c(0),p=n=>{a.value=n},e=c(null),{elementX:d,elementY:i,isOutside:r}=bt(e),f=c(0),u=c(0),m=c(0),l=c(0);return Y([d,i,r],()=>{r.value||(d.value>100&&d.value<300&&(f.value=d.value-100),i.value>100&&i.value<300&&(u.value=i.value-100),d.value<100&&(f.value=0),d.value>300&&(f.value=200),i.value<100&&(u.value=0),i.value>300&&(u.value=200),m.value=-f.value*2,l.value=-u.value*2)}),(n,_)=>(b(),y("div",yt,[t("div",{class:"middle",ref_key:"target",ref:e},[t("img",{src:o.imageList[a.value],class:"img-fluid object-fit-cover w-100",style:{height:"400px"},alt:""},null,8,wt),R(t("div",{class:"layer",style:D({left:`${f.value}px`,top:`${u.value}px`})},null,4),[[B,!j(r)]])],512),t("ul",xt,[(b(!0),y(X,null,U(o.imageList,(v,g)=>(b(),y("li",{class:K(["list-unstyled",{active:g===a.value}]),key:g,onMouseenter:w=>p(g)},[t("img",{src:v,class:"img-fluid object-fit-cover w-100 h-100",alt:""},null,8,Ct)],42,kt))),128))]),R(t("div",{class:"large",style:D([{backgroundImage:`url(${o.imageList[a.value]})`,backgroundPositionX:`${m.value}px`,backgroundPositionY:`${l.value}px`}])},null,4),[[B,!j(r)]])]))}},Mt=H(Pt,[["__scopeId","data-v-31539fe8"]]);var St={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Tt={setup(){const{VITE_APP_URL:o,VITE_APP_PATH:a}=St,p=J(),e=Q(),d=st(),{getCart:i}=d,r=nt(),{pushMessage:f}=r,u=c(e.params.productId),m=c([]),l=c({loadingItem:""}),n=()=>{O.get(`${o}/api/${a}/products`).then(s=>{m.value=s.data.products}).catch(s=>{alert(s.response.data.message)})},_=s=>{x.value=s,k(),p.push(`/product/${s.id}`).then(()=>{window.scrollTo(0,0)})},v=c({}),g=c([]),w=c(1),x=c(e.params),k=()=>{O.get(`${o}/api/${a}/product/${x.value.id}`).then(s=>{v.value=s.data.product,g.value=s.data.product.imagesUrl,console.log(s.data.product.imagesUrl),console.log(s.data.product)})},E=c(["時尚配件","休閒娛樂","生活用品"]),P=()=>{const{category:s=""}=e.query,h=`${o}/api/${a}/products?category=${s}`;O.get(h).then(S=>{v.value=S.data.products})},M=s=>{l.value.loadingItem=s;const h={product_id:s,qty:w.value},S=`${o}/api/${a}/cart`;O.post(S,{data:h}).then(z=>{l.value.loadingItem="",f({style:"success",title:"加入購物車",content:z.data.message}),i()})};return k(),Y(()=>e.query,()=>{P(),k(),i()}),Z(()=>{k(),i(),P(),n()}),{modules:[it,lt,dt,ut],products:m,openModal:_,addToCart:M,product:v,imagesUrl:g,qty:w,categories:E,getProducts:P,gProduct:x,id:u,status:l}},components:{Swiper:ct,SwiperSlide:rt,ImageComponent:Mt,ToastMessages:at}},Et={id:"app"},It={class:"container mt-8 p-0"},At={"aria-label":"breadcrumb"},Lt={class:"breadcrumb"},Vt={class:"breadcrumb-item",to:"/"},Ot={class:"breadcrumb-item"},Xt={class:"breadcrumb-item active","aria-current":"page"},Yt={class:"row mt-5"},$t=t("div",{class:"col-md-2"},null,-1),jt={class:"col-md-10"},Rt={class:"row"},Ut={class:"col-md-6"},qt={class:"row"},Bt={class:"col-md-6 ps-5 d-flex flex-column justify-content-between"},Dt={class:"fs-4 mb-4"},Ht={class:"mb-4"},Wt={key:0,class:"text-gray2 fs-5"},Nt={key:1,class:"d-flex align-items-center"},zt={class:"text-gray2 fs-5"},Ft={class:"text-brown fs-4 ms-3"},Gt={class:"mb-5"},Kt=t("div",{class:"fs-6 mb-2"},"商品內容:",-1),Jt={class:"input-group w-50 mb-4"},Qt=["disabled"],Zt={class:"row m-0"},te={class:"d-flex justify-content-center align-items-center me-5 p-0",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #e9b888"}},ee={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},oe={class:"d-flex justify-content-center align-items-center p-0",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #e9b888"}},se={class:"row mt-8"},ne=t("div",{class:"fs-6 mb-4"},"商品詳情:",-1),ae={style:{"white-space":"pre-wrap"}},ie={class:"list-unstyled mb-3"},le=["src"],ce={class:"container mt-8 p-0"},re=t("h3",{class:"text-center text-brown"},[L(" 猜你喜歡 "),t("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),de={id:"swiper"},ue={class:"col-md-9"},pe=["onClick"],me={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},_e=["src"],ve={class:"card-body"},fe={class:"card-title"},ge={class:"card-title text-brown"},he=["onClick"],be={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},ye=t("i",{class:"bi bi-cart-plus"},null,-1);function we(o,a,p,e,d,i){const r=I("RouterLink"),f=I("ImageComponent"),u=I("swiper-slide"),m=I("swiper"),l=I("ToastMessages");return b(),y(X,null,[t("div",Et,[t("div",It,[t("nav",At,[t("ol",Lt,[t("li",Vt,[T(r,{class:"text-black text-decoration-none",to:"/"},{default:A(()=>[L("首頁")]),_:1})]),t("li",Ot,[T(r,{class:"text-black text-decoration-none",to:"/products"},{default:A(()=>[L("產品")]),_:1})]),t("li",Xt,C(e.product.category),1)])]),t("div",Yt,[$t,t("div",jt,[t("div",Rt,[t("div",Ut,[t("div",qt,[T(f,{imageList:e.imagesUrl},null,8,["imageList"])])]),t("div",Bt,[t("div",Dt,C(e.product.title),1),t("div",Ht,[e.product.price===e.product.origin_price?(b(),y("div",Wt," $"+C(e.product.origin_price),1)):(b(),y("div",Nt,[t("del",zt,"$"+C(e.product.origin_price),1),t("div",Ft,"$"+C(e.product.price),1)]))]),t("div",Gt,[Kt,t("div",null,C(e.product.content),1)]),t("div",Jt,[t("button",{type:"button",class:"btn btn-outline-lightBrown",disabled:e.qty===1,onClick:a[0]||(a[0]=n=>e.qty--)}," - ",8,Qt),R(t("input",{"onUpdate:modelValue":a[1]||(a[1]=n=>e.qty=n),type:"number",min:"1",max:"20",class:"form-control text-center","aria-label":"Dollar amount (with dot and two decimal places)",readonly:""},null,512),[[tt,e.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-outline-lightBrown",onClick:a[2]||(a[2]=n=>e.qty++)}," + ")]),t("div",Zt,[t("div",te,[t("button",{type:"button",class:"loginbtn text-center bg-lightBrown border-0",onClick:a[3]||(a[3]=n=>e.addToCart(e.product.id))},[e.product.id===e.status.loadingItem?(b(),y("span",ee)):$("",!0),L(" 加入購物車 ")])]),t("div",oe,[T(r,{class:"loginbtn text-center bg-brown d-block",to:"/cart",onClick:a[4]||(a[4]=n=>e.addToCart(e.product.id))},{default:A(()=>[L("立即購買")]),_:1})])])])]),t("div",se,[ne,t("div",ae,C(e.product.description),1)]),(b(!0),y(X,null,U(e.imagesUrl,n=>(b(),y("div",{class:"row mt-5",key:n},[t("li",ie,[t("img",{src:n,class:"w-50",alt:""},null,8,le)])]))),128))])]),t("div",ce,[re,t("div",de,[T(m,{slidesPerView:4,grabCursor:!0,pagination:{clickable:!0},modules:e.modules,class:"mySwiper",navigation:!0,mousewheel:!0,keyboard:!0},{default:A(()=>[(b(!0),y(X,null,U(e.products,n=>(b(),et(u,{key:n.id},{default:A(()=>[t("div",ue,[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5",onClick:_=>e.openModal(n)},[n.price!==n.origin_price?(b(),y("span",me,"SALE")):$("",!0),t("img",{src:n.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,_e),t("div",ve,[t("p",fe,C(n.title),1),t("p",ge,"$ "+C(n.price),1),t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:ot(_=>e.addToCart(n.id,1),["stop"])},[n.id===e.status.loadingItem?(b(),y("span",be)):$("",!0),ye],8,he)])],8,pe)])]),_:2},1024))),128))]),_:1},8,["modules"])])])])]),T(l)],64)}const Ee=H(Tt,[["render",we]]);export{Ee as default};
