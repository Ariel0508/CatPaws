import{a as V}from"./axios-G2rPRu76.js";import{_ as K,j as Q,k as W,f as r,q as X,g as Y,r as P,o as i,c as l,a as t,b as h,w as x,F as w,m as $,d as A,t as m,i as F,p as Z,s as tt,v as et}from"./index-e58kpYGg.js";import{u as st}from"./cartStore-0_Vqyyck.js";import{_ as ot}from"./PaginationComponent-kfHB0CWO.js";import{u as at}from"./toastMessage-HPO1lieS.js";import{_ as nt}from"./ToastMessages-qLDrA4kN.js";import{_ as ct}from"./loading-bneA9sLj.js";var rt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:M,VITE_APP_PATH:R}=rt,it={setup(){const u=st(),{getCart:d}=u,D=at(),{pushMessage:s}=D,y=Q(),v=W(),k=r(v.params.productId),g=r([]),b=r({loadingItem:""}),p=r(!1),e=r([]),f=r(0),N=r(0),B=r(["時尚配件","休閒娛樂","生活用品"]),S=()=>{const{category:o=""}=v.query,n=`${M}/api/${R}/products?category=${o}`;V.get(n).then(c=>{g.value=c.data.products,L.value=c.data.pagination}).catch(c=>{alert(c.response.data.message)})},L=r({}),C=(o=1)=>{const{category:n=""}=v.query,c=`${M}/api/${R}/products?category=${n}&page=${o}`;p.value=!0,V.get(c).then(_=>{const I=_.data.products.slice();T.value==="high"?(I.sort((q,E)=>E.price-q.price),document.querySelector(".heightPrice").classList.add("activeC"),document.querySelector(".lowPrice").classList.remove("activeC")):T.value==="low"&&(I.sort((q,E)=>q.price-E.price),document.querySelector(".lowPrice").classList.add("activeC"),document.querySelector(".heightPrice").classList.remove("activeC")),g.value=I,L.value=_.data.pagination,p.value=!1}).catch(_=>{alert(_.response.data.message),p.value=!1})},T=r(""),U=o=>{T.value=o,C()},H=o=>{b.value.loadingItem=o;const n={product_id:o,qty:1},c=`${M}/api/${R}/cart`;V.post(c,{data:n}).then(_=>{b.value.loadingItem="",s({style:"success",title:"加入購物車",content:_.data.message}),d()})},O=o=>{y.push(`/product/${o.id}`).then(()=>{window.scrollTo(0,0)})},j=r(0),z=o=>{document.querySelectorAll(".activeCategory").forEach((c,_)=>{_===o?c.classList.add("activeC"):c.classList.remove("activeC")}),j.value=o},G=()=>{document.querySelectorAll(".activeCategory").forEach(n=>{n.classList.remove("activeC")})},J=o=>{const n=o.target.value;n==="全部產品"?y.push({path:"/products",query:{category:""}}):y.push(`/products?category=${n}`)};return X(()=>v.query,()=>{S(),C()}),Y(()=>{C(),S()}),{id:k,products:g,categories:B,status:b,isLoading:p,getProducts:S,sortProducts:U,addToCart:H,openModal:O,getData:C,pagination:L,carts:e,finalTotal:f,total:N,activeIndex:j,enterhandler:z,handleCategoryChange:J,handleAllProductsClick:G}},components:{Pagination:ot,ToastMessages:nt}},a=u=>(tt("data-v-ce45d20f"),u=u(),et(),u),lt={id:"app"},dt=a(()=>t("img",{src:ct,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1)),ut={class:"container mt-7 p-0"},_t={"aria-label":"breadcrumb"},gt={class:"breadcrumb"},pt={class:"breadcrumb-item",to:"/"},ht=a(()=>t("li",{class:"breadcrumb-item active","aria-current":"page"},"產品",-1)),mt={class:"row mt-5"},vt={class:"col-md-3"},bt={class:"mSale"},ft={class:"d-flex justify-content-end mb-3"},yt=a(()=>t("option",{selected:""},"全部產品",-1)),Ct={class:"d-flex justify-content-end mb-5"},Pt=a(()=>t("option",{selected:""},"價格",-1)),xt=a(()=>t("option",{value:"high"},"價格高到低",-1)),wt=a(()=>t("option",{value:"low"},"價格低到高",-1)),kt=[Pt,xt,wt],St={class:"pSale"},Lt={class:"list-unstyled mb-2"},Tt={class:"fs-4 text-gray2 mb-2 list-unstyled"},It=a(()=>t("div",{class:"fs-4 text-gray2 mt-3 mb-2"},"篩選條件",-1)),qt=a(()=>t("span",{class:"heightPrice"},"價格高到低",-1)),Et=[qt],Vt=a(()=>t("br",null,null,-1)),$t=a(()=>t("span",{class:"lowPrice"},"價格低到高",-1)),At=[$t],Mt={class:"col-md-9"},Rt={class:"row"},Dt=["onClick"],Nt={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown"},jt=["src"],Ft={class:"card-body"},Bt={class:"card-title text-center"},Ut={key:0,class:"text-gray2 fs-5 card-title text-center"},Ht={key:1,class:"d-flex justify-content-center align-items-center card-title ms-2"},Ot={class:"text-gray2 fs-5"},zt={class:"text-brown fs-5 ms-3"},Gt=a(()=>t("br",null,null,-1)),Jt=["onClick"],Kt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Qt=a(()=>t("i",{class:"bi bi-cart-plus"},null,-1)),Wt={class:"d-flex justify-content-end"};function Xt(u,d,D,s,y,v){const k=P("VueLoading"),g=P("RouterLink"),b=P("Pagination"),p=P("ToastMessages");return i(),l(w,null,[t("div",lt,[h(k,{active:s.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:x(()=>[dt]),_:1},8,["active"]),t("div",ut,[t("nav",_t,[t("ol",gt,[t("li",pt,[h(g,{class:"text-black text-decoration-none",to:"/"},{default:x(()=>[A("首頁")]),_:1})]),ht])]),t("div",mt,[t("div",vt,[t("div",bt,[t("div",ft,[t("select",{class:"p-1 text-center text-gray2 border-end-0 border-start-0 border-brown bg-vanilla w-100","aria-label":"Default select example",onChange:d[0]||(d[0]=(...e)=>s.handleCategoryChange&&s.handleCategoryChange(...e))},[yt,(i(!0),l(w,null,$(s.categories,e=>(i(),l("option",{key:e},m(e),1))),128))],32)]),t("div",Ct,[t("select",{class:"p-1 text-gray2 border-end-0 border-start-0 border-top-0 border-bottom-1 border-brown bg-lightVanilla","aria-label":"Default select example",onChange:d[1]||(d[1]=e=>s.sortProducts(e.target.value))},kt,32)])]),t("div",St,[t("ul",Lt,[t("li",Tt,[h(g,{class:"text-decoration-none text-gray2",to:{path:"/products",query:{category:""}},onClick:s.handleAllProductsClick},{default:x(()=>[A(" 全部產品 ")]),_:1},8,["onClick"])]),(i(!0),l(w,null,$(s.categories,(e,f)=>(i(),l("li",{key:e,class:"fs-6 mb-2 list-unstyled"},[h(g,{class:"activeCategory",to:`/products?category=${e}`,onClick:N=>s.enterhandler(f)},{default:x(()=>[A(m(e),1)]),_:2},1032,["to","onClick"])]))),128))]),It,t("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:d[2]||(d[2]=e=>s.sortProducts("high"))},Et),Vt,t("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:d[3]||(d[3]=e=>s.sortProducts("low"))},At)])]),t("div",Mt,[t("div",Rt,[(i(!0),l(w,null,$(s.products,e=>(i(),l("div",{class:"col-md-4 col-6 mb-5",key:e.id},[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5",onClick:f=>s.openModal(e)},[e.price!==e.origin_price?(i(),l("span",Nt,"SALE")):F("",!0),t("img",{src:e.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"280px"},alt:"productPicture"},null,8,jt),t("div",Ft,[t("p",Bt,m(e.title),1),e.price===e.origin_price?(i(),l("div",Ut," $"+m(u.$filters.numberToCurrencyNo(e.origin_price)),1)):(i(),l("div",Ht,[t("del",Ot,"$"+m(u.$filters.numberToCurrencyNo(e.origin_price)),1),t("div",zt," $"+m(u.$filters.numberToCurrencyNo(e.price)),1)])),Gt,t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:Z(f=>s.addToCart(e.id,1),["stop"])},[e.id===s.status.loadingItem?(i(),l("span",Kt)):F("",!0),Qt],8,Jt)])],8,Dt)]))),128)),t("div",Wt,[h(b,{pages:s.pagination,onEmitPages:s.getData},null,8,["pages","onEmitPages"])])])])])])]),h(p)],64)}const ne=K(it,[["render",Xt],["__scopeId","data-v-ce45d20f"]]);export{ne as default};
