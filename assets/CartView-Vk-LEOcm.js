import{N as D,P as N,S as z,a as F}from"./pagination-WlznZS4s.js";import{M as Q,K as H}from"./mousewheel-m2Jvx6FX.js";import{_ as K,k as O,l as W,f as m,v as G,g as J,m as X,r as v,o as n,c as i,a as t,F as P,p as L,t as d,b,w as y,d as x,z as Y,B as Z,j as $,q as tt,s as et}from"./index-gh1Wuwja.js";import{a as g}from"./axios-G2rPRu76.js";import{u as st}from"./cartStore-hNeT1rAu.js";import{u as ot}from"./toastMessage-gtw7JEM3.js";import{C as nt}from"./CouponModal--HaMuo5G.js";import{_ as it}from"./ToastMessages-IWzdNRXF.js";const at="/week8/assets/empty-cart-Cdy4DvIF.png";var lt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const rt={setup(){const{VITE_APP_URL:u,VITE_APP_PATH:_}=lt,V=O(),o=W(),T=st(),S=ot(),{pushMessage:c}=S,{getCart:h}=T,C=m([]),k=m(o.params.productId),w=m({}),e=m({loadingItem:""}),l=()=>{const{category:s=""}=o.query,a=`${u}/api/${_}/products?category=${s}`;g.get(a).then(r=>{C.value=r.data.products,console.log(r.data.products)})},B=s=>{V.push(`/product/${s.id}`).then(()=>{window.scrollTo(0,0)})},q=m(null),f=()=>{const s=`${u}/api/${_}/cart`;g.get(s).then(a=>{w.value=a.data.data})},E=(s,a=1)=>{const r={product_id:s.product_id,qty:a};e.value.loadingItem=s.id;const p=`${u}/api/${_}/cart/${s.id}`;g.put(p,{data:r}).then(()=>{e.value.loadingItem="",f()})},R=()=>{q.value.oModal()},A=s=>{e.value.loadingItem=s;const a={product_id:s,qty:1},r=`${u}/api/${_}/cart`;g.post(r,{data:a}).then(p=>{e.value.loadingItem="",c({style:"success",title:"加入購物車",content:p.data.message}),h()})},U=s=>{e.value.loadingItem=s;const a=`${u}/api/${_}/cart/${s}`;g.delete(a).then(r=>{e.value.loadingItem="",c({style:"success",title:"刪除成功",content:r.data.message}),h(),f()})},j=s=>{const a=`${u}/api/${_}/cart/${s.id}`,r={product_id:s.product_id,qty:s.qty};g.put(a,{data:r}).then(p=>{c({style:"success",title:"更新購物車",content:p.data.message}),h()}).catch(p=>{c({style:"danger",title:"更新購物車",content:p.response.data.message})})},M=m(4),I=()=>{window.innerWidth<=767?M.value=2:M.value=4};return G(()=>w.value,()=>{f()}),J(()=>{h(),f(),l(),I(),window.addEventListener("resize",I)}),X(()=>{window.removeEventListener("resize",I)}),{modules:[D,N,Q,H],products:C,id:k,openModal:B,carts:w,status:e,changeCartQty:E,CouponModalRef:q,openCouponModal:R,removeCartItem:U,addToCart:A,getProducts:l,getCartList:f,updateCart:j,slidesPerView:M}},components:{Swiper:z,SwiperSlide:F,CouponModaL:nt,ToastMessages:it}},ct=t("div",{class:"container mt-8 p-0"},[t("nav",{"aria-label":"breadcrumb"},[t("ol",{class:"breadcrumb"},[t("li",{class:"breadcrumb-item active","aria-current":"page"},"購物車")])])],-1),dt={class:"container mt-5"},ut={class:"row"},_t={key:0,class:"table align-middle border-lightBrown"},pt=t("thead",null,[t("tr",null,[t("th",{class:"ps-3"},"商品名稱"),t("th",null,"單價"),t("th",{width:"180",class:"text-center"},"數量"),t("th",null,"小計"),t("th",null,"刪除")])],-1),ht=["src"],mt={class:"input-group w-100"},bt=["disabled","onClick"],gt=t("span",{style:{height:"16px",width:"16px"}},"-",-1),wt=[gt],ft=["onClick"],vt=t("span",{style:{height:"16px",width:"16px"}},[t("i",{class:"bi bi-trash"})],-1),yt=[vt],xt=["onUpdate:modelValue","disabled"],Ct=["onClick"],kt=t("span",{style:{height:"16px",width:"16px"}},"+",-1),Mt=[kt],It=["onClick"],Pt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},$t=t("i",{class:"bi bi-trash"},null,-1),Vt={class:"border-white"},Tt={colspan:"2",class:"text-brown fs-5"},St={class:"row d-flex justify-content-end"},qt={colspan:"3",class:"ps-7"},Lt={class:"row d-flex justify-content-center"},Bt={class:"d-flex justify-content-center align-items-center p-0",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #e9b888"}},Et={key:1,class:"text-center mb-8"},Rt=t("img",{src:at,class:"img-fluid object-fit-cover w-25",alt:"emptycartpicture"},null,-1),At={class:"text-brown fs-5"},Ut=t("br",null,null,-1),jt={class:"container mt-8 p-0"},Dt=t("h3",{class:"text-center text-brown"},[x(" 猜你喜歡 "),t("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),Nt={id:"swiper"},zt={class:"row"},Ft=["onClick"],Qt={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},Ht=["src"],Kt={class:"card-body"},Ot={class:"card-title"},Wt={key:0,class:"text-gray2 fs-5 card-title"},Gt={key:1,class:"d-flex align-items-center card-title ms-2"},Jt={class:"text-gray2 fs-5"},Xt={class:"text-brown fs-4 ms-3"},Yt=["onClick"],Zt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},te=t("i",{class:"bi bi-cart-plus"},null,-1);function ee(u,_,V,o,T,S){const c=v("RouterLink"),h=v("swiper-slide"),C=v("swiper"),k=v("ToastMessages"),w=v("CouponModaL");return n(),i(P,null,[ct,t("div",dt,[t("div",ut,[o.carts.total!==0?(n(),i("table",_t,[pt,t("tbody",null,[(n(!0),i(P,null,L(o.carts.carts,e=>(n(),i("tr",{key:e.id},[t("td",null,[t("div",null,[t("div",null,[t("img",{src:e.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,ht)]),b(c,{class:"text-decoration-none text-black",to:`/product/${e.product.id}`},{default:y(()=>[x(d(e.product.title),1)]),_:2},1032,["to"])])]),t("td",null,"$"+d(e.product.price),1),t("td",null,[t("div",mt,[e.qty>1?(n(),i("button",{key:0,type:"button",class:"btn btn-outline-lightBrown",disabled:e.qty===1,onClick:l=>{e.qty--,o.changeCartQty(e,e.qty)}},wt,8,bt)):(n(),i("button",{key:1,type:"button",class:"btn btn-outline-brown border-lightBrown",onClick:l=>o.removeCartItem(e.id)},yt,8,ft)),Y(t("input",{"onUpdate:modelValue":l=>e.qty=l,type:"number",min:"1",max:"20",class:"form-control text-center","aria-label":"Dollar amount (with dot and two decimal places)",readonly:"",disabled:e.productId===o.status.loadingItem},null,8,xt),[[Z,e.qty]]),t("button",{type:"button",class:"btn btn-outline-lightBrown",onClick:l=>{e.qty++,o.changeCartQty(e,e.qty)}},Mt,8,Ct)])]),t("td",null,"$"+d(e.total),1),t("td",null,[t("button",{class:"btn btn-outline-brown border-0",onClick:l=>o.removeCartItem(e.id)},[e.id===o.status.loadingItem?(n(),i("span",Pt)):$("",!0),$t],8,It)])]))),128))]),t("tfoot",null,[t("tr",Vt,[t("td",Tt,[t("div",St," 總金額:$"+d(o.carts.final_total)+"元 ",1)]),t("td",qt,[t("div",Lt,[t("div",Bt,[b(c,{class:"loginbtn text-center bg-brown d-block",to:"/order",onclick:"window.scrollTo(0, 0);"},{default:y(()=>[x("立即結帳")]),_:1})])])])])])])):(n(),i("div",Et,[Rt,t("div",At,[x(" 購物車還沒有商品呦~ "),Ut,b(c,{to:"/products",class:"btn btn-brown text-decoration-none m-3"},{default:y(()=>[x("按我去選購")]),_:1})])]))])]),t("div",jt,[Dt,t("div",Nt,[b(C,{slidesPerView:o.slidesPerView,grabCursor:!0,spaceBetween:30,pagination:{clickable:!0},freeMode:!0,modules:o.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:y(()=>[(n(!0),i(P,null,L(o.products,e=>(n(),tt(h,{key:e.id},{default:y(()=>[t("div",zt,[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5 col-12 ms-3 p-0",onClick:l=>o.openModal(e)},[e.price!==e.origin_price?(n(),i("span",Qt,"SALE")):$("",!0),t("img",{src:e.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,Ht),t("div",Kt,[t("p",Ot,d(e.title),1),e.price===e.origin_price?(n(),i("div",Wt," $"+d(e.origin_price),1)):(n(),i("div",Gt,[t("del",Jt,"$"+d(e.origin_price),1),t("div",Xt,"$"+d(e.price),1)])),t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:et(l=>o.addToCart(e.id,1),["stop"])},[e.id===o.status.loadingItem?(n(),i("span",Zt)):$("",!0),te],8,Yt)])],8,Ft)])]),_:2},1024))),128))]),_:1},8,["slidesPerView","modules"])])]),b(k),b(w,{ref:"CouponModalRef"},null,512)],64)}const de=K(rt,[["render",ee]]);export{de as default};
