import{P as R,M as F,K as O,S as U,a as D}from"./pagination-y2TH4Nut.js";import{_ as q,k as z,l as H,g as _,h as K,r as m,o as r,c as i,b as x,w as k,a as t,B as G,F as T,m as C,t as o,q as N,d as B,j as b,e as J,n as Q}from"./index--Yu1lQES.js";import{a as v}from"./axios-G2rPRu76.js";import{u as W}from"./cartStore-JKc8lqzV.js";import{u as X}from"./toastMessage-4WHJh_XD.js";import{_ as Y}from"./ToastMessages-T5GF66Br.js";import{_ as Z}from"./loading-bneA9sLj.js";var tt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const et={setup(){const{VITE_APP_URL:a,VITE_APP_PATH:l}=tt,P=z(),s=H(),M=W(),S=X(),{pushMessage:u}=S,{getCart:h}=M,g=_({}),f=_(s.params.productId),e=_([]),p=_({loadingItem:""}),d=_(!1),$=()=>{d.value=!0,v.get(`${a}/api/${l}/products`).then(n=>{e.value=n.data.products,d.value=!1}).catch(n=>{alert(n.response.data.message),d.value=!1})},I=n=>{P.push(`/product/${n.id}`).then(()=>{window.scrollTo(0,0)})},E=n=>{p.value.loadingItem=n;const c={product_id:n,qty:1},j=`${a}/api/${l}/cart`;v.post(j,{data:c}).then(A=>{p.value.loadingItem="",u({style:"success",title:"加入購物車",content:A.data.message}),h()})},w=_(s.params.orderId),V=_({user:{}}),y=()=>{const n=`${a}/api/${l}/order/${w.value}`;d.value=!0,v.get(n).then(c=>{V.value=c.data.order,d.value=!1}).catch(c=>{u({style:"danger",title:"錯誤訊息",content:c.response.data.message}),d.value=!1})},L=()=>{const n=`${a}/api/${l}/pay/${w.value}`;d.value=!0,v.post(n).then(()=>{y(),d.value=!1,u({style:"success",title:"付款成功",content:"感謝您的支持"})}).catch(c=>{u({style:"danger",title:"錯誤訊息",content:c.response.data.message}),d.value=!1}),window.scrollTo(0,0)};return y(),K(()=>{$(),h()}),{modules:[R,F,O],products:e,carts:g,openModal:I,addToCart:E,getOrder:y,getCart:h,id:f,status:p,isLoading:d,order:V,orderId:w,payOrder:L}},components:{Swiper:U,SwiperSlide:D,ToastMessages:Y}},st=t("img",{src:Z,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1),ot={class:"container mt-7 p-0"},rt={"aria-label":"breadcrumb"},it={class:"breadcrumb"},at={key:0,class:"breadcrumb-item active","aria-current":"page"},nt={key:1,class:"breadcrumb-item active","aria-current":"page"},dt={class:"container-fluid mt-6 rwdStep"},lt={class:"position-relative m-4"},ct=t("div",{class:"progress",style:{height:"2px"}},[t("div",{class:"progress-bar",role:"progressbar",style:{width:"100%"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})],-1),_t=t("button",{type:"button",class:"position-absolute top-0 start-0 translate-middle btn btn-sm btn-brown rounded-pill",style:{width:"2rem",height:"2rem"}}," 1 ",-1),ut=t("button",{type:"button",class:"position-absolute top-0 start-50 translate-middle btn btn-sm btn-brown rounded-pill",style:{width:"2rem",height:"2rem"}}," 2 ",-1),ht=J('<div class="pt-1"><div class="position-relative m-4"><div class="position-absolute top-0 start-0 translate-middle" style="width:4rem;height:2rem;"> 確認商品 </div><div class="position-absolute top-0 start-50 translate-middle" style="width:4rem;height:2rem;"> 填寫資料 </div><div class="position-absolute top-0 start-100 translate-middle" style="width:4rem;height:2rem;"> 完成訂單 </div></div></div>',1),pt={class:"container mt-5"},mt={class:"row"},bt={class:"table pc align-middle border-bottom border-lightBrown"},vt=t("thead",null,[t("tr",{class:"text-center"},[t("th",{width:"200"},"商品名稱"),t("th",{width:"120"},"單價"),t("th",{width:"200",class:"text-center"},"數量"),t("th",{width:"200"},"小計")])],-1),gt={class:"text-center"},ft=["src"],wt={class:"border-bottom border-white"},yt={colspan:"4",class:"text-end pe-8"},xt={class:"text-brown fs-5 text-end mt-3"},kt={class:"mobile"},Tt={class:"row"},Ct={class:"col-4 p-0"},Pt=["src"],Mt={class:"col-8 p-0"},St={class:"mt-3 d-flex justify-content-between"},Vt={class:"col-3 text-center"},Nt={class:"border-top border-lightBrown p-4 bg-white"},Bt={class:"text-brown fs-5 text-end"},$t={class:"row px-2 py-5 fs-6"},It={class:"mb-5"},Et={key:0,class:"text-danger fw-bold"},Lt={key:1,class:"text-success fw-bold"},jt={class:"col-md-6 col-12"},At={class:"mb-3"},Rt={class:"mb-3"},Ft={class:"mb-3"},Ot={class:"mb-4"},Ut={class:"mb-3 text-gray2"},Dt={class:"col-md-6 col-12"},qt=t("div",{class:"mb-3"},"留言",-1),zt={class:"border border-1 rounded p-2 w-100 bg-white",style:{height:"150px"}},Ht={key:0,class:"text-end"},Kt=t("div",null,[t("button",{type:"submit",class:"btn p-0 border-0"},[t("div",{class:"d-flex justify-content-center text-brown"},[t("div",{class:"d-flex align-items-center justify-content-center",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #a2672d"}},[t("a",{class:"text-center bg-brown text-decoration-none text-white m-1 d-block",style:{width:"175px",height:"30px","line-height":"30px"}},"確認付款 ")])])])],-1),Gt=[Kt],Jt={key:0,class:"container mt-8 p-0"},Qt=t("h3",{class:"text-center text-brown"},[B(" 猜你喜歡 "),t("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),Wt={id:"swiper"},Xt=["onClick"],Yt={key:0,class:"position-absolute top-0 start-0 fw-bold fs-6 text-white p-2 bg-brown"},Zt=["src"],te={class:"card-body"},ee={class:"card-title"},se={key:0,class:"text-gray2 fs-5 card-title text-center"},oe={key:1,class:"d-flex align-items-center justify-content-center card-title ms-2"},re={class:"text-gray2 fs-5"},ie={class:"text-brown fs-5 ms-3"},ae=t("br",null,null,-1),ne=["onClick"],de={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},le=t("i",{class:"bi bi-cart-plus"},null,-1);function ce(a,l,P,s,M,S){const u=m("VueLoading"),h=m("swiper-slide"),g=m("swiper"),f=m("ToastMessages");return r(),i("div",null,[x(u,{active:s.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:k(()=>[st]),_:1},8,["active"]),t("div",ot,[t("nav",rt,[t("ol",it,[s.order.is_paid===!0?(r(),i("li",at," 訂單完成!感謝您的購買! ")):(r(),i("li",nt," 待付款訂單 "))])])]),t("div",dt,[t("div",lt,[ct,_t,ut,t("button",{type:"button",class:G(["position-absolute top-0 start-100 translate-middle btn btn-sm rounded-pill",s.order.is_paid?"btn-brown":"btn-gray2"]),style:{width:"2rem",height:"2rem"}}," 3 ",2)]),ht]),t("div",pt,[t("div",mt,[t("table",bt,[vt,t("tbody",gt,[(r(!0),i(T,null,C(s.order.products,e=>(r(),i("tr",{key:e.id},[t("td",null,[t("div",null,[t("img",{src:e.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,ft),t("div",null,o(e.product.title),1)])]),t("td",null,"$"+o(a.$filters.numberToCurrencyNo(e.product.price)),1),t("td",null,o(e.qty),1),t("td",null,"$"+o(a.$filters.numberToCurrencyNo(e.total)),1)]))),128))]),t("tfoot",wt,[t("tr",null,[t("td",yt,[t("div",xt," 訂單金額：$"+o(a.$filters.numberToCurrencyNo(Math.floor(s.order.total)))+"元 ",1)])])])]),t("div",kt,[(r(!0),i(T,null,C(s.order.products,e=>(r(),i("div",{class:"border-top border-lightBrown p-3 bg-white",key:e.id},[t("div",Tt,[t("div",Ct,[t("img",{src:e.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,Pt)]),t("div",Mt,[t("div",null,o(e.product.title),1),t("div",St,[t("div",null,"$"+o(a.$filters.numberToCurrencyNo(e.total)),1),t("div",Vt,"x "+o(e.qty),1)])])])]))),128)),t("div",Nt,[t("div",Bt," 訂單金額：$"+o(a.$filters.numberToCurrencyNo(Math.floor(s.order.total)))+"元 ",1)])])]),t("form",{onSubmit:l[0]||(l[0]=N((...e)=>s.payOrder&&s.payOrder(...e),["prevent"]))},[t("div",$t,[t("div",It,[B(" 付款狀態 "),s.order.is_paid?(r(),i("span",Lt,"付款完成")):(r(),i("span",Et,"尚未付款"))]),t("div",jt,[t("div",At,"送貨地址："+o(s.order.user.address),1),t("div",Rt,"Email："+o(s.order.user.email),1),t("div",Ft,"顧客姓名："+o(s.order.user.name),1),t("div",Ot,"電話："+o(s.order.user.tel),1),t("div",Ut," 下單時間："+o(a.$filters.date(s.order.create_at)),1)]),t("div",Dt,[qt,t("div",zt,o(s.order.message),1)])]),s.order.is_paid===!1?(r(),i("div",Ht,Gt)):b("",!0)],32)]),s.order.is_paid===!0?(r(),i("div",Jt,[Qt,t("div",Wt,[x(g,{slidesPerView:1,spaceBetween:10,pagination:{clickable:!0},breakpoints:{640:{slidesPerView:2,spaceBetween:20},1024:{slidesPerView:4,spaceBetween:30}},grabCursor:!0,freeMode:!0,modules:s.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:k(()=>[(r(!0),i(T,null,C(s.products,e=>(r(),Q(h,{key:e.id},{default:k(()=>[t("div",{style:{height:"450px"},class:"card shadow-sm rounded-lg border-0 position-relative mb-5",onClick:p=>s.openModal(e)},[e.price!==e.origin_price?(r(),i("span",Yt,"SALE")):b("",!0),t("img",{src:e.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,Zt),t("div",te,[t("p",ee,o(e.title),1),e.price===e.origin_price?(r(),i("div",se," $"+o(a.$filters.numberToCurrencyNo(e.origin_price)),1)):(r(),i("div",oe,[t("del",re,"$"+o(a.$filters.numberToCurrencyNo(e.origin_price)),1),t("div",ie," $"+o(a.$filters.numberToCurrencyNo(e.price)),1)])),ae,t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:N(p=>s.addToCart(e.id,1),["stop"])},[e.id===s.status.loadingItem?(r(),i("span",de)):b("",!0),le],8,ne)])],8,Xt)]),_:2},1024))),128))]),_:1},8,["modules"])])])):b("",!0),x(f)])}const ge=q(et,[["render",ce]]);export{ge as default};
