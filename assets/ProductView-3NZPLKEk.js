import{a as A}from"./axios-G2rPRu76.js";import{x as G,y as K,u as X,g as l,v as B,_ as U,o as h,c as y,a as e,z as Y,A as D,B as H,F as j,n as R,C as J,k as Q,l as Z,h as ee,r as S,b as P,w as L,t as x,D as te,j as N,d as $,q as se,s as oe}from"./index-Rs64tiZ4.js";import{u as ne}from"./cartStore-WW17UfBk.js";import{u as ie}from"./toastMessage-WOPfrOkh.js";import{_ as ae}from"./ToastMessages-3-YMT132.js";import{P as le,N as re,S as ce,a as de}from"./pagination-Hf7Lg4Bp.js";import{M as ue,K as me}from"./mousewheel-pXrvFIxU.js";import{_ as pe}from"./loading-bneA9sLj.js";function fe(s){return G()?(K(s),!0):!1}function W(s){return typeof s=="function"?s():X(s)}const _e=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ve=Object.prototype.toString,ge=s=>ve.call(s)==="[object Object]",he=()=>{};function F(s){var n;const f=W(s);return(n=f==null?void 0:f.$el)!=null?n:f}const q=_e?window:void 0;function I(...s){let n,f,t,u;if(typeof s[0]=="string"||Array.isArray(s[0])?([f,t,u]=s,n=q):[n,f,t,u]=s,!n)return he;Array.isArray(f)||(f=[f]),Array.isArray(t)||(t=[t]);const r=[],p=()=>{r.forEach(c=>c()),r.length=0},g=(c,i,o,v)=>(c.addEventListener(i,o,v),()=>c.removeEventListener(i,o,v)),m=B(()=>[F(n),W(u)],([c,i])=>{if(p(),!c)return;const o=ge(i)?{...i}:i;r.push(...f.flatMap(v=>t.map(b=>g(c,v,b,o))))},{immediate:!0,flush:"post"}),_=()=>{m(),p()};return fe(_),_}const be={page:s=>[s.pageX,s.pageY],client:s=>[s.clientX,s.clientY],screen:s=>[s.screenX,s.screenY],movement:s=>s instanceof Touch?null:[s.movementX,s.movementY]};function ye(s={}){const{type:n="page",touch:f=!0,resetOnTouchEnds:t=!1,initialValue:u={x:0,y:0},window:r=q,target:p=r,scroll:g=!0,eventFilter:m}=s;let _=null;const c=l(u.x),i=l(u.y),o=l(null),v=typeof n=="function"?n:be[n],b=a=>{const d=v(a);_=a,d&&([c.value,i.value]=d,o.value="mouse")},w=a=>{if(a.touches.length>0){const d=v(a.touches[0]);d&&([c.value,i.value]=d,o.value="touch")}},k=()=>{if(!_||!r)return;const a=v(_);_ instanceof MouseEvent&&a&&(c.value=a[0]+r.scrollX,i.value=a[1]+r.scrollY)},M=()=>{c.value=u.x,i.value=u.y},E=m?a=>m(()=>b(a),{}):a=>b(a),V=m?a=>m(()=>w(a),{}):a=>w(a),C=m?()=>m(()=>k(),{}):()=>k();if(p){const a={passive:!0};I(p,["mousemove","dragover"],E,a),f&&n!=="movement"&&(I(p,["touchstart","touchmove"],V,a),t&&I(p,"touchend",M,a)),g&&n==="page"&&I(r,"scroll",C,{passive:!0})}return{x:c,y:i,sourceType:o}}function we(s,n={}){const{handleOutside:f=!0,window:t=q}=n,u=n.type||"page",{x:r,y:p,sourceType:g}=ye(n),m=l(s??(t==null?void 0:t.document.body)),_=l(0),c=l(0),i=l(0),o=l(0),v=l(0),b=l(0),w=l(!0);let k=()=>{};return t&&(k=B([m,r,p],()=>{const M=F(m);if(!M)return;const{left:E,top:V,width:C,height:a}=M.getBoundingClientRect();i.value=E+(u==="page"?t.pageXOffset:0),o.value=V+(u==="page"?t.pageYOffset:0),v.value=a,b.value=C;const d=r.value-i.value,T=p.value-o.value;w.value=C===0||a===0||d<0||T<0||d>C||T>a,(f||!w.value)&&(_.value=d,c.value=T)},{immediate:!0}),I(document,"mouseleave",()=>{w.value=!0})),{x:r,y:p,sourceType:g,elementX:_,elementY:c,elementPositionX:i,elementPositionY:o,elementHeight:v,elementWidth:b,isOutside:w,stop:k}}const xe={class:"goods-image flex-column d-flex p-0"},ke=["src"],Ce={class:"small d-flex px-0 m-0"},Te=["onMouseenter"],Pe=["src"],Me={__name:"ImageComponentView",props:{imageList:{type:Array,default:()=>[]}},setup(s){const n=l(0),f=i=>{n.value=i},t=l(null),{elementX:u,elementY:r,isOutside:p}=we(t),g=l(0),m=l(0),_=l(0),c=l(0);return B([u,r,p],()=>{p.value||(u.value>125&&u.value<325&&(g.value=u.value-125),r.value>125&&r.value<325&&(m.value=r.value-125),u.value<125&&(g.value=0),u.value>325&&(g.value=225),r.value<125&&(m.value=0),r.value>325&&(m.value=225),_.value=-g.value*2,c.value=-m.value*2)}),(i,o)=>(h(),y("div",xe,[e("div",{class:"middle",ref_key:"target",ref:t},[e("img",{src:s.imageList[n.value],class:"img-fluid object-fit-cover w-100",alt:""},null,8,ke),Y(e("div",{class:"layer",style:H({left:`${g.value}px`,top:`${m.value}px`})},null,4),[[D,!X(p)]])],512),e("ul",Ce,[(h(!0),y(j,null,R(s.imageList,(v,b)=>(h(),y("li",{class:J(["list-unstyled p-0 me-2",{active:b===n.value}]),key:b,onMouseenter:w=>f(b)},[e("img",{src:v,class:"img-fluid object-fit-cover w-100 h-100",alt:""},null,8,Pe)],42,Te))),128))]),Y(e("div",{class:"large",style:H([{backgroundImage:`url(${s.imageList[n.value]})`,backgroundPositionX:`${_.value}px`,backgroundPositionY:`${c.value}px`}])},null,4),[[D,!X(p)]])]))}},Se=U(Me,[["__scopeId","data-v-006988ee"]]);var Le={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Ee={setup(){const{VITE_APP_URL:s,VITE_APP_PATH:n}=Le,f=Q(),t=Z(),u=ne(),{getCart:r}=u,p=ie(),{pushMessage:g}=p,m=l(t.params.productId),_=l([]),c=l({loadingItem:""}),i=l(!1),o=l({}),v=l([]),b=l(1),w=l(t.params),k=()=>{i.value=!0,A.get(`${s}/api/${n}/product/${w.value.id}`).then(d=>{o.value=d.data.product,v.value=d.data.product.imagesUrl,i.value=!1})},M=()=>{i.value=!0,A.get(`${s}/api/${n}/products`).then(d=>{_.value=d.data.products,i.value=!1}).catch(d=>{alert(d.response.data.message),i.value=!1})},E=d=>{w.value=d,f.push(`/product/${d.id}`).then(()=>{window.scrollTo(0,0)}),k()},V=l(["時尚配件","休閒娛樂","生活用品"]),C=()=>{const{category:d=""}=t.query,T=`${s}/api/${n}/products?category=${d}`;i.value=!0,A.get(T).then(O=>{o.value=O.data.products,i.value=!1})},a=d=>{c.value.loadingItem=d;const T={product_id:d,qty:b.value},O=`${s}/api/${n}/cart`;A.post(O,{data:T}).then(z=>{c.value.loadingItem="",g({style:"success",title:"加入購物車",content:z.data.message}),r(),window.scrollTo(0,0)})};return B(()=>t.query,()=>{C(),r()}),ee(()=>{k(),r(),M()}),{modules:[le,re,ue,me],products:_,openModal:E,addToCart:a,product:o,imagesUrl:v,qty:b,categories:V,getProducts:C,gProduct:w,id:m,status:c,isLoading:i}},components:{Swiper:ce,SwiperSlide:de,ImageComponent:Se,ToastMessages:ae}},Ve={id:"app"},$e=e("img",{src:pe,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1),Ie={class:"container mt-7"},Ae={"aria-label":"breadcrumb"},je={class:"breadcrumb"},Be={class:"breadcrumb-item",to:"/"},Oe={class:"breadcrumb-item"},Ne={class:"breadcrumb-item active","aria-current":"page"},Xe={class:"row mt-5"},Ye={class:"col-lg-6 col-12"},Re={class:"col-lg-6 col-12 d-flex flex-column justify-content-between"},qe={class:"fs-4 mb-4"},De={class:"mb-4"},He={key:0,class:"text-gray2 fs-5"},Ue={key:1,class:"d-flex align-items-center"},We={class:"text-gray2 fs-5"},Fe={class:"text-brown fs-4 ms-3"},ze={class:"mb-5"},Ge=e("div",{class:"fs-6 mb-2"},"商品內容:",-1),Ke={class:"input-group mb-4 w-100"},Je=["disabled"],Qe={class:"d-flex mb-3 justify-content-between"},Ze={class:"d-flex justify-content-center text-brown"},et={class:"d-flex align-items-center justify-content-center btnHover",style:{width:"150px",height:"40px",background:"#ffffff",border:"1px solid #e8b887"}},tt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},st={class:"d-flex justify-content-center text-brown"},ot={class:"d-flex align-items-center justify-content-center",style:{width:"150px",height:"40px",background:"#ffffff",border:"1px solid #a2672d"}},nt={class:"mt-8"},it=e("div",{class:"fs-6 mb-4"},"商品詳情:",-1),at={style:{"white-space":"pre-wrap"}},lt={class:"list-unstyled mb-3 col-12 col-md-7"},rt=["src"],ct={class:"container mt-8"},dt=e("h3",{class:"text-center text-brown"},[$(" 猜你喜歡 "),e("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),ut={id:"swiper"},mt=["onClick"],pt={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},ft=["src"],_t={class:"card-body"},vt={class:"card-title"},gt={key:0,class:"text-gray2 fs-5 card-title text-center"},ht={key:1,class:"d-flex justify-content-center align-items-center card-title ms-2"},bt={class:"text-gray2 fs-5"},yt={class:"text-brown fs-5 ms-3"},wt=e("br",null,null,-1),xt=["onClick"],kt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Ct=e("i",{class:"bi bi-cart-plus"},null,-1);function Tt(s,n,f,t,u,r){const p=S("VueLoading"),g=S("RouterLink"),m=S("ImageComponent"),_=S("swiper-slide"),c=S("swiper"),i=S("ToastMessages");return h(),y(j,null,[e("div",Ve,[P(p,{active:t.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:L(()=>[$e]),_:1},8,["active"]),e("div",Ie,[e("nav",Ae,[e("ol",je,[e("li",Be,[P(g,{class:"text-black text-decoration-none",to:"/"},{default:L(()=>[$("首頁")]),_:1})]),e("li",Oe,[P(g,{class:"text-black text-decoration-none",to:"/products"},{default:L(()=>[$("產品")]),_:1})]),e("li",Ne,x(t.product.category),1)])]),e("div",Xe,[e("div",Ye,[P(m,{imageList:t.imagesUrl,class:"mb-8"},null,8,["imageList"])]),e("div",Re,[e("div",qe,x(t.product.title),1),e("div",De,[t.product.price===t.product.origin_price?(h(),y("div",He," $"+x(s.$filters.numberToCurrencyNo(t.product.origin_price)),1)):(h(),y("div",Ue,[e("del",We,"$"+x(s.$filters.numberToCurrencyNo(t.product.origin_price)),1),e("div",Fe," $"+x(s.$filters.numberToCurrencyNo(t.product.price)),1)]))]),e("div",ze,[Ge,e("div",null,x(t.product.content),1)]),e("div",Ke,[e("button",{type:"button",class:"btn btn-outline-lightBrown",disabled:t.qty===1,onClick:n[0]||(n[0]=o=>t.qty--)}," - ",8,Je),Y(e("input",{"onUpdate:modelValue":n[1]||(n[1]=o=>t.qty=o),type:"number",min:"1",max:"20",class:"form-control text-center","aria-label":"Dollar amount (with dot and two decimal places)",readonly:""},null,512),[[te,t.qty,void 0,{number:!0}]]),e("button",{type:"button",class:"btn btn-outline-lightBrown",onClick:n[2]||(n[2]=o=>t.qty++)}," + ")]),e("div",Qe,[e("div",Ze,[e("div",et,[e("div",{class:"text-center bg-lightBrown text-white m-1",style:{width:"140px",height:"30px","line-height":"30px"},onClick:n[3]||(n[3]=o=>t.addToCart(t.product.id))},[t.product.id===t.status.loadingItem?(h(),y("span",tt)):N("",!0),$(" 加入購物車 ")])])]),e("div",st,[e("div",ot,[P(g,{to:"/cart",class:"text-center bg-brown text-decoration-none text-white m-1",style:{width:"140px",height:"30px","line-height":"30px"},onClick:n[4]||(n[4]=o=>t.addToCart(t.product.id))},{default:L(()=>[$("立即購買 ")]),_:1})])])])])]),e("div",nt,[it,e("div",at,x(t.product.description),1)]),(h(!0),y(j,null,R(t.imagesUrl,o=>(h(),y("div",{class:"mt-5",key:o},[e("li",lt,[e("img",{src:o,class:"w-100",alt:""},null,8,rt)])]))),128))])]),e("div",ct,[dt,e("div",ut,[P(c,{slidesPerView:1,spaceBetween:10,pagination:{clickable:!0},breakpoints:{640:{slidesPerView:2,spaceBetween:20},1024:{slidesPerView:4,spaceBetween:30}},grabCursor:!0,freeMode:!0,modules:t.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:L(()=>[(h(!0),y(j,null,R(t.products,o=>(h(),se(_,{key:o.id},{default:L(()=>[e("div",{style:{height:"450px"},class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5 p-0",onClick:v=>t.openModal(o)},[o.price!==o.origin_price?(h(),y("span",pt,"SALE")):N("",!0),e("img",{src:o.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,ft),e("div",_t,[e("p",vt,x(o.title),1),o.price===o.origin_price?(h(),y("div",gt," $"+x(s.$filters.numberToCurrencyNo(o.origin_price)),1)):(h(),y("div",ht,[e("del",bt,"$"+x(s.$filters.numberToCurrencyNo(o.origin_price)),1),e("div",yt," $"+x(s.$filters.numberToCurrencyNo(o.price)),1)])),wt,e("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:oe(v=>t.addToCart(o.id,1),["stop"])},[o.id===t.status.loadingItem?(h(),y("span",kt)):N("",!0),Ct],8,xt)])],8,mt)]),_:2},1024))),128))]),_:1},8,["modules"])])]),P(i)],64)}const At=U(Ee,[["render",Tt]]);export{At as default};
