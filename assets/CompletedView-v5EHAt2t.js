import{P as U,N as D,S as $,a as j}from"./pagination-WlznZS4s.js";import{_ as q,k as z,l as F,f as c,g as H,m as W,r as x,o as r,c as n,a as t,s as E,F as k,p as M,d as m,t as o,j as P,b as B,w as I,q as G}from"./index-gh1Wuwja.js";import{a as p}from"./axios-G2rPRu76.js";import{u as J}from"./cartStore-hNeT1rAu.js";import{u as K}from"./toastMessage-gtw7JEM3.js";import{_ as Q}from"./ToastMessages-IWzdNRXF.js";var X={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Y={setup(){const{VITE_APP_URL:l,VITE_APP_PATH:a}=X,S=z(),s=F(),T=J(),V=K(),{pushMessage:_}=V,{getCart:u}=T,b=c(s.params.productId),h=c([]),e=c({loadingItem:""}),g=()=>{p.get(`${l}/api/${a}/products`).then(i=>{h.value=i.data.products}).catch(i=>{alert(i.response.data.message)})},A=i=>{S.push(`/product/${i.id}`).then(()=>{window.scrollTo(0,0)})},L=i=>{e.value.loadingItem=i;const d={product_id:i,qty:1},N=`${l}/api/${a}/cart`;p.post(N,{data:d}).then(O=>{e.value.loadingItem="",_({style:"success",title:"加入購物車",content:O.data.message}),u()})},w=c(s.params.orderId),C=c({user:{}}),v=()=>{const i=`${l}/api/${a}/order/${w.value}`;p.get(i).then(d=>{C.value=d.data.order}).catch(d=>{_({style:"danger",title:"錯誤訊息",content:d.response.data.message})})},R=()=>{const i=`${l}/api/${a}/pay/${w.value}`;p.post(i).then(()=>{v()}).catch(d=>{_({style:"danger",title:"錯誤訊息",content:d.response.data.message})}),window.scrollTo(0,0)};v();const f=c(4),y=()=>{window.innerWidth<=767?f.value=2:f.value=4};return H(()=>{g(),y(),window.addEventListener("resize",y)}),W(()=>{window.removeEventListener("resize",y)}),{modules:[U,D],products:h,openModal:A,addToCart:L,getOrder:v,getCart:u,id:b,status:e,order:C,orderId:w,payOrder:R,slidesPerView:f}},components:{Swiper:$,SwiperSlide:j,ToastMessages:Q}},Z={class:"container mt-8 p-0"},tt={"aria-label":"breadcrumb"},et={class:"breadcrumb"},st={key:0,class:"breadcrumb-item active","aria-current":"page"},ot={key:1,class:"breadcrumb-item active","aria-current":"page"},rt={class:"container mt-5"},nt={class:"row"},it={class:"table align-middle border-bottom border-lightBrown m-0"},at=t("thead",null,[t("tr",null,[t("th",{width:"2%"}),t("th",{width:"30%"},"訂單商品"),t("th",{width:"8%"}),t("th",{width:"20%"},"單價"),t("th",{width:"20%"},"數量"),t("th",{width:"20%"},"小計")])],-1),dt=t("td",null,null,-1),ct=["src"],lt=t("td",null,null,-1),_t=t("td",null,[t("div",{class:"form-check"})],-1),ht=t("td",null,null,-1),ut=t("td",{class:"text-lightBrown"},null,-1),pt={colspan:"4",class:"text-end"},mt={class:"text-brown fs-5"},bt={class:"row justify-content-center bg-white px-8 py-6"},gt={class:"col-md-6"},wt={class:"mb-3"},vt={class:"mb-3"},ft={class:"mb-3"},yt={class:"mb-3"},xt={class:"col-md-6"},kt=t("div",{class:"mb-3"},"留言",-1),Pt={class:"border border-1 rounded p-2 mb-3 w-100",style:{height:"100px"}},St={class:"text-end"},Tt={key:0,class:"text-danger"},Vt={key:1,class:"text-success"},Ct={key:0,class:"p-3 bg-white row border-top border-1 border-lightBrown"},Et=t("div",{class:"text-end"},[t("button",{type:"submit",class:"btn p-0 border-0"},[t("div",{class:"d-flex justify-content-center align-items-center p-0",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #e9b888"}},[t("button",{type:"submit",class:"loginbtn text-center bg-lightBrown border-0"},"確認付款去")])])],-1),Mt=[Et],Bt={class:"container mt-8 p-0"},It=t("h3",{class:"text-center text-brown"},[m(" 猜你喜歡 "),t("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),At={id:"swiper"},Lt={class:"row"},Rt=["onClick"],Nt={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},Ot=["src"],Ut={class:"card-body"},Dt={class:"card-title"},$t={key:0,class:"text-gray2 fs-5 card-title"},jt={key:1,class:"d-flex align-items-center card-title ms-2"},qt={class:"text-gray2 fs-5"},zt={class:"text-brown fs-4 ms-3"},Ft=["onClick"],Ht={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Wt=t("i",{class:"bi bi-cart-plus"},null,-1);function Gt(l,a,S,s,T,V){var h;const _=x("swiper-slide"),u=x("swiper"),b=x("ToastMessages");return r(),n(k,null,[t("div",Z,[t("nav",tt,[t("ol",et,[s.order.is_paid===!0?(r(),n("li",st," 訂單完成!感謝您的購買! ")):(r(),n("li",ot,"待付款訂單"))])])]),t("div",rt,[t("form",{onSubmit:a[0]||(a[0]=E((...e)=>s.payOrder&&s.payOrder(...e),["prevent"]))},[t("div",nt,[t("table",it,[at,t("tbody",null,[(r(!0),n(k,null,M(s.order.products,e=>(r(),n("tr",{key:e.id},[dt,t("td",null,[t("img",{src:e.product.imageUrl,style:{width:"80px",height:"80px"},alt:""},null,8,ct),m(" "+o(e.product.title),1)]),lt,t("td",null,"$"+o(e.product.price),1),t("td",null,o(e.qty),1),t("td",null,"$"+o(e.final_total),1)]))),128))]),t("tfoot",null,[t("tr",null,[_t,ht,ut,t("td",pt,[m("訂單金額("+o((h=s.order.products)==null?void 0:h.length)+"商品):",1),t("span",mt,"$"+o(s.order.total),1)])])])])]),t("div",bt,[t("div",gt,[t("div",wt,"送貨地址:"+o(s.order.user.address),1),t("div",vt,"Email:"+o(s.order.user.email),1),t("div",ft,"顧客姓名:"+o(s.order.user.name),1),t("div",yt,"電話:"+o(s.order.user.tel),1)]),t("div",xt,[kt,t("div",Pt,o(s.order.message),1)]),t("div",St,[m("付款狀態 "),s.order.is_paid?(r(),n("span",Vt,"付款完成")):(r(),n("span",Tt,"尚未付款"))])]),s.order.is_paid===!1?(r(),n("div",Ct,Mt)):P("",!0)],32)]),t("div",Bt,[It,t("div",At,[B(u,{slidesPerView:s.slidesPerView,grabCursor:!0,spaceBetween:30,pagination:{clickable:!0},freeMode:!0,modules:s.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:I(()=>[(r(!0),n(k,null,M(s.products,e=>(r(),G(_,{key:e.id},{default:I(()=>[t("div",Lt,[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relativemb-5 col-12 ms-3 p-0",onClick:g=>s.openModal(e)},[e.price!==e.origin_price?(r(),n("span",Nt,"SALE")):P("",!0),t("img",{src:e.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,Ot),t("div",Ut,[t("p",Dt,o(e.title),1),e.price===e.origin_price?(r(),n("div",$t," $"+o(e.origin_price),1)):(r(),n("div",jt,[t("del",qt,"$"+o(e.origin_price),1),t("div",zt,"$"+o(e.price),1)])),t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:E(g=>s.addToCart(e.id,1),["stop"])},[e.id===s.status.loadingItem?(r(),n("span",Ht)):P("",!0),Wt],8,Ft)])],8,Rt)])]),_:2},1024))),128))]),_:1},8,["slidesPerView","modules"])])]),B(b)],64)}const te=q(Y,[["render",Gt]]);export{te as default};
