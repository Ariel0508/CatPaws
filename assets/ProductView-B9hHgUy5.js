import{a as j}from"./axios-G2rPRu76.js";import{x as J,y as Q,u as R,g as l,v as O,_ as F,o as g,c as y,a as t,z as U,A as H,B as W,F as B,n as q,C as Z,k as ee,l as te,h as se,m as oe,r as L,b as S,w as E,t as k,D as ne,j as Y,d as $,q as ie,s as ae}from"./index-uSsl23hN.js";import{u as le}from"./cartStore-cT4yMnq_.js";import{u as re}from"./toastMessage-JDYJgB3a.js";import{_ as ce}from"./ToastMessages-KB8ckqvl.js";import{P as de,N as ue,S as me,a as pe}from"./pagination-8r-E7CPD.js";import{M as fe,K as ve}from"./mousewheel-G4V8L4SL.js";import{_ as _e}from"./loading-bneA9sLj.js";function ge(s){return J()?(Q(s),!0):!1}function z(s){return typeof s=="function"?s():R(s)}const he=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const be=Object.prototype.toString,ye=s=>be.call(s)==="[object Object]",we=()=>{};function G(s){var o;const p=z(s);return(o=p==null?void 0:p.$el)!=null?o:p}const D=he?window:void 0;function A(...s){let o,p,e,d;if(typeof s[0]=="string"||Array.isArray(s[0])?([p,e,d]=s,o=D):[o,p,e,d]=s,!o)return we;Array.isArray(p)||(p=[p]),Array.isArray(e)||(e=[e]);const r=[],m=()=>{r.forEach(c=>c()),r.length=0},_=(c,i,n,f)=>(c.addEventListener(i,n,f),()=>c.removeEventListener(i,n,f)),u=O(()=>[G(o),z(d)],([c,i])=>{if(m(),!c)return;const n=ye(i)?{...i}:i;r.push(...p.flatMap(f=>e.map(h=>_(c,f,h,n))))},{immediate:!0,flush:"post"}),v=()=>{u(),m()};return ge(v),v}const xe={page:s=>[s.pageX,s.pageY],client:s=>[s.clientX,s.clientY],screen:s=>[s.screenX,s.screenY],movement:s=>s instanceof Touch?null:[s.movementX,s.movementY]};function ke(s={}){const{type:o="page",touch:p=!0,resetOnTouchEnds:e=!1,initialValue:d={x:0,y:0},window:r=D,target:m=r,scroll:_=!0,eventFilter:u}=s;let v=null;const c=l(d.x),i=l(d.y),n=l(null),f=typeof o=="function"?o:xe[o],h=a=>{const w=f(a);v=a,w&&([c.value,i.value]=w,n.value="mouse")},x=a=>{if(a.touches.length>0){const w=f(a.touches[0]);w&&([c.value,i.value]=w,n.value="touch")}},C=()=>{if(!v||!r)return;const a=f(v);v instanceof MouseEvent&&a&&(c.value=a[0]+r.scrollX,i.value=a[1]+r.scrollY)},P=()=>{c.value=d.x,i.value=d.y},V=u?a=>u(()=>h(a),{}):a=>h(a),I=u?a=>u(()=>x(a),{}):a=>x(a),T=u?()=>u(()=>C(),{}):()=>C();if(m){const a={passive:!0};A(m,["mousemove","dragover"],V,a),p&&o!=="movement"&&(A(m,["touchstart","touchmove"],I,a),e&&A(m,"touchend",P,a)),_&&o==="page"&&A(r,"scroll",T,{passive:!0})}return{x:c,y:i,sourceType:n}}function Ce(s,o={}){const{handleOutside:p=!0,window:e=D}=o,d=o.type||"page",{x:r,y:m,sourceType:_}=ke(o),u=l(s??(e==null?void 0:e.document.body)),v=l(0),c=l(0),i=l(0),n=l(0),f=l(0),h=l(0),x=l(!0);let C=()=>{};return e&&(C=O([u,r,m],()=>{const P=G(u);if(!P)return;const{left:V,top:I,width:T,height:a}=P.getBoundingClientRect();i.value=V+(d==="page"?e.pageXOffset:0),n.value=I+(d==="page"?e.pageYOffset:0),f.value=a,h.value=T;const w=r.value-i.value,M=m.value-n.value;x.value=T===0||a===0||w<0||M<0||w>T||M>a,(p||!x.value)&&(v.value=w,c.value=M)},{immediate:!0}),A(document,"mouseleave",()=>{x.value=!0})),{x:r,y:m,sourceType:_,elementX:v,elementY:c,elementPositionX:i,elementPositionY:n,elementHeight:f,elementWidth:h,isOutside:x,stop:C}}const Te={class:"goods-image flex-column d-flex p-0"},Pe=["src"],Me={class:"small d-flex px-0 m-0"},Se=["onMouseenter"],Le=["src"],Ee={__name:"ImageComponentView",props:{imageList:{type:Array,default:()=>[]}},setup(s){const o=l(0),p=i=>{o.value=i},e=l(null),{elementX:d,elementY:r,isOutside:m}=Ce(e),_=l(0),u=l(0),v=l(0),c=l(0);return O([d,r,m],()=>{m.value||(d.value>125&&d.value<325&&(_.value=d.value-125),r.value>125&&r.value<325&&(u.value=r.value-125),d.value<125&&(_.value=0),d.value>325&&(_.value=225),r.value<125&&(u.value=0),r.value>325&&(u.value=225),v.value=-_.value*2,c.value=-u.value*2)}),(i,n)=>(g(),y("div",Te,[t("div",{class:"middle",ref_key:"target",ref:e},[t("img",{src:s.imageList[o.value],class:"img-fluid object-fit-cover w-100",alt:""},null,8,Pe),U(t("div",{class:"layer",style:W({left:`${_.value}px`,top:`${u.value}px`})},null,4),[[H,!R(m)]])],512),t("ul",Me,[(g(!0),y(B,null,q(s.imageList,(f,h)=>(g(),y("li",{class:Z(["list-unstyled p-0 me-2",{active:h===o.value}]),key:h,onMouseenter:x=>p(h)},[t("img",{src:f,class:"img-fluid object-fit-cover w-100 h-100",alt:""},null,8,Le)],42,Se))),128))]),U(t("div",{class:"large",style:W([{backgroundImage:`url(${s.imageList[o.value]})`,backgroundPositionX:`${v.value}px`,backgroundPositionY:`${c.value}px`}])},null,4),[[H,!R(m)]])]))}},Ve=F(Ee,[["__scopeId","data-v-006988ee"]]);var Ie={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const $e={setup(){const{VITE_APP_URL:s,VITE_APP_PATH:o}=Ie,p=ee(),e=te(),d=le(),{getCart:r}=d,m=re(),{pushMessage:_}=m,u=l(e.params.productId),v=l([]),c=l({loadingItem:""}),i=l(!1),n=()=>{i.value=!0,j.get(`${s}/api/${o}/products`).then(b=>{v.value=b.data.products,i.value=!1}).catch(b=>{alert(b.response.data.message),i.value=!1})},f=l({}),h=l([]),x=l(1),C=l(e.params),P=()=>{i.value=!0,j.get(`${s}/api/${o}/product/${C.value.id}`).then(b=>{f.value=b.data.product,h.value=b.data.product.imagesUrl,i.value=!1})};P();const V=b=>{C.value=b,P(),p.push(`/product/${b.id}`).then(()=>{window.scrollTo(0,0)})},I=l(["時尚配件","休閒娛樂","生活用品"]),T=()=>{const{category:b=""}=e.query,N=`${s}/api/${o}/products?category=${b}`;i.value=!0,j.get(N).then(X=>{f.value=X.data.products,i.value=!1})},a=b=>{c.value.loadingItem=b;const N={product_id:b,qty:x.value},X=`${s}/api/${o}/cart`;j.post(X,{data:N}).then(K=>{c.value.loadingItem="",_({style:"success",title:"加入購物車",content:K.data.message}),r(),window.scrollTo(0,0)})},w=l(4),M=()=>{window.innerWidth<=767?w.value=1:w.value=4};return O(()=>e.query,()=>{T(),r()}),se(()=>{P(),r(),T(),n(),M(),window.addEventListener("resize",M)}),oe(()=>{window.removeEventListener("resize",M)}),{modules:[de,ue,fe,ve],products:v,openModal:V,addToCart:a,product:f,imagesUrl:h,qty:x,categories:I,getProducts:T,gProduct:C,id:u,status:c,slidesPerView:w,isLoading:i}},components:{Swiper:me,SwiperSlide:pe,ImageComponent:Ve,ToastMessages:ce}},Ae={id:"app"},je=t("img",{src:_e,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1),Be={class:"container mt-7"},Oe={"aria-label":"breadcrumb"},Ne={class:"breadcrumb"},Xe={class:"breadcrumb-item",to:"/"},Ye={class:"breadcrumb-item"},Re={class:"breadcrumb-item active","aria-current":"page"},Ue={class:"row mt-5"},qe={class:"col-lg-6 col-12"},De={class:"col-lg-6 col-12 d-flex flex-column justify-content-between"},He={class:"fs-4 mb-4"},We={class:"mb-4"},Fe={key:0,class:"text-gray2 fs-5"},ze={key:1,class:"d-flex align-items-center"},Ge={class:"text-gray2 fs-5"},Ke={class:"text-brown fs-4 ms-3"},Je={class:"mb-5"},Qe=t("div",{class:"fs-6 mb-2"},"商品內容:",-1),Ze={class:"input-group mb-4 w-100"},et=["disabled"],tt={class:"d-flex mb-3 justify-content-between"},st={class:"d-flex justify-content-center text-brown"},ot={class:"d-flex align-items-center justify-content-center",style:{width:"150px",height:"40px",background:"#ffffff",border:"1px solid #e8b887"}},nt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},it={class:"d-flex justify-content-center text-brown"},at={class:"d-flex align-items-center justify-content-center",style:{width:"150px",height:"40px",background:"#ffffff",border:"1px solid #a2672d"}},lt={class:"mt-8"},rt=t("div",{class:"fs-6 mb-4"},"商品詳情:",-1),ct={style:{"white-space":"pre-wrap"}},dt={class:"list-unstyled mb-3 col-12 col-md-7"},ut=["src"],mt={class:"container mt-8"},pt=t("h3",{class:"text-center text-brown"},[$(" 猜你喜歡 "),t("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),ft={id:"swiper"},vt=["onClick"],_t={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},gt=["src"],ht={class:"card-body"},bt={class:"card-title"},yt={key:0,class:"text-gray2 fs-5 card-title text-center"},wt={key:1,class:"d-flex justify-content-center align-items-center card-title ms-2"},xt={class:"text-gray2 fs-5"},kt={class:"text-brown fs-5 ms-3"},Ct=t("br",null,null,-1),Tt=["onClick"],Pt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Mt=t("i",{class:"bi bi-cart-plus"},null,-1);function St(s,o,p,e,d,r){const m=L("VueLoading"),_=L("RouterLink"),u=L("ImageComponent"),v=L("swiper-slide"),c=L("swiper"),i=L("ToastMessages");return g(),y(B,null,[t("div",Ae,[S(m,{active:e.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:E(()=>[je]),_:1},8,["active"]),t("div",Be,[t("nav",Oe,[t("ol",Ne,[t("li",Xe,[S(_,{class:"text-black text-decoration-none",to:"/"},{default:E(()=>[$("首頁")]),_:1})]),t("li",Ye,[S(_,{class:"text-black text-decoration-none",to:"/products"},{default:E(()=>[$("產品")]),_:1})]),t("li",Re,k(e.product.category),1)])]),t("div",Ue,[t("div",qe,[S(u,{imageList:e.imagesUrl,class:"mb-8"},null,8,["imageList"])]),t("div",De,[t("div",He,k(e.product.title),1),t("div",We,[e.product.price===e.product.origin_price?(g(),y("div",Fe," $"+k(s.$filters.numberToCurrencyNo(e.product.origin_price)),1)):(g(),y("div",ze,[t("del",Ge,"$"+k(s.$filters.numberToCurrencyNo(e.product.origin_price)),1),t("div",Ke," $"+k(s.$filters.numberToCurrencyNo(e.product.price)),1)]))]),t("div",Je,[Qe,t("div",null,k(e.product.content),1)]),t("div",Ze,[t("button",{type:"button",class:"btn btn-outline-lightBrown",disabled:e.qty===1,onClick:o[0]||(o[0]=n=>e.qty--)}," - ",8,et),U(t("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>e.qty=n),type:"number",min:"1",max:"20",class:"form-control text-center","aria-label":"Dollar amount (with dot and two decimal places)",readonly:""},null,512),[[ne,e.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-outline-lightBrown",onClick:o[2]||(o[2]=n=>e.qty++)}," + ")]),t("div",tt,[t("div",st,[t("div",ot,[t("div",{class:"text-center bg-lightBrown text-white m-1 btnHover",style:{width:"140px",height:"30px","line-height":"30px"},onClick:o[3]||(o[3]=n=>e.addToCart(e.product.id))},[e.product.id===e.status.loadingItem?(g(),y("span",nt)):Y("",!0),$(" 加入購物車 ")])])]),t("div",it,[t("div",at,[S(_,{to:"/cart",class:"text-center bg-brown text-decoration-none text-white m-1",style:{width:"140px",height:"30px","line-height":"30px"},onClick:o[4]||(o[4]=n=>e.addToCart(e.product.id))},{default:E(()=>[$("立即購買 ")]),_:1})])])])])]),t("div",lt,[rt,t("div",ct,k(e.product.description),1)]),(g(!0),y(B,null,q(e.imagesUrl,n=>(g(),y("div",{class:"mt-5",key:n},[t("li",dt,[t("img",{src:n,class:"w-100",alt:""},null,8,ut)])]))),128))])]),t("div",mt,[pt,t("div",ft,[S(c,{slidesPerView:e.slidesPerView,grabCursor:!0,spaceBetween:30,pagination:{clickable:!0},freeMode:!0,modules:e.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:E(()=>[(g(!0),y(B,null,q(e.products,n=>(g(),ie(v,{key:n.id},{default:E(()=>[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5 col-md-12 col-12 p-0",onClick:f=>e.openModal(n)},[n.price!==n.origin_price?(g(),y("span",_t,"SALE")):Y("",!0),t("img",{src:n.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,gt),t("div",ht,[t("p",bt,k(n.title),1),n.price===n.origin_price?(g(),y("div",yt," $"+k(s.$filters.numberToCurrencyNo(n.origin_price)),1)):(g(),y("div",wt,[t("del",xt,"$"+k(s.$filters.numberToCurrencyNo(n.origin_price)),1),t("div",kt," $"+k(s.$filters.numberToCurrencyNo(n.price)),1)])),Ct,t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:ae(f=>e.addToCart(n.id,1),["stop"])},[n.id===e.status.loadingItem?(g(),y("span",Pt)):Y("",!0),Mt],8,Tt)])],8,vt)]),_:2},1024))),128))]),_:1},8,["slidesPerView","modules"])])]),S(i)],64)}const Ot=F($e,[["render",St]]);export{Ot as default};
