import{P as R,M as F,K as O,S as U,a as D}from"./pagination-LHt2JKKa.js";import{_ as q,k as H,l as K,g as _,h as z,r as m,o as r,c as a,b as y,w as x,a as e,F as k,m as T,t as o,q as $,d as N,j as C,n as G}from"./index-lOYKTrqc.js";import{a as b}from"./axios-G2rPRu76.js";import{u as J}from"./cartStore-zvzn7o5o.js";import{u as Q}from"./toastMessage-Ejf1zxCP.js";import{_ as W}from"./ToastMessages-z9_qVJA-.js";import{_ as X}from"./loading-bneA9sLj.js";var Y={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Z={setup(){const{VITE_APP_URL:i,VITE_APP_PATH:c}=Y,P=H(),s=K(),M=J(),V=Q(),{pushMessage:u}=V,{getCart:h}=M,g=_({}),f=_(s.params.productId),t=_([]),p=_({loadingItem:""}),d=_(!1),B=()=>{d.value=!0,b.get(`${i}/api/${c}/products`).then(n=>{t.value=n.data.products,d.value=!1}).catch(n=>{alert(n.response.data.message),d.value=!1})},I=n=>{P.push(`/product/${n.id}`).then(()=>{window.scrollTo(0,0)})},E=n=>{p.value.loadingItem=n;const l={product_id:n,qty:1},A=`${i}/api/${c}/cart`;b.post(A,{data:l}).then(j=>{p.value.loadingItem="",u({style:"success",title:"加入購物車",content:j.data.message}),h()})},v=_(s.params.orderId),S=_({user:{}}),w=()=>{const n=`${i}/api/${c}/order/${v.value}`;d.value=!0,b.get(n).then(l=>{S.value=l.data.order,d.value=!1}).catch(l=>{u({style:"danger",title:"錯誤訊息",content:l.response.data.message}),d.value=!1})},L=()=>{const n=`${i}/api/${c}/pay/${v.value}`;d.value=!0,b.post(n).then(()=>{w(),d.value=!1,u({style:"success",title:"付款成功",content:"感謝您的支持"})}).catch(l=>{u({style:"danger",title:"錯誤訊息",content:l.response.data.message}),d.value=!1}),window.scrollTo(0,0)};return w(),z(()=>{B(),h()}),{modules:[R,F,O],products:t,carts:g,openModal:I,addToCart:E,getOrder:w,getCart:h,id:f,status:p,isLoading:d,order:S,orderId:v,payOrder:L}},components:{Swiper:U,SwiperSlide:D,ToastMessages:W}},ee=e("img",{src:X,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1),te={class:"container mt-7 p-0"},se={"aria-label":"breadcrumb"},oe={class:"breadcrumb"},re={key:0,class:"breadcrumb-item active","aria-current":"page"},ae={key:1,class:"breadcrumb-item active","aria-current":"page"},ie={class:"container mt-5"},ne={class:"row"},de={class:"table pc align-middle border-bottom border-lightBrown"},ce=e("thead",null,[e("tr",{class:"text-center"},[e("th",{width:"200"},"商品名稱"),e("th",{width:"120"},"單價"),e("th",{width:"200",class:"text-center"},"數量"),e("th",{width:"200"},"小計")])],-1),le={class:"text-center"},_e=["src"],ue={class:"border-bottom border-white"},he={colspan:"4",class:"text-end pe-8"},pe={class:"text-brown fs-5 text-end mt-3"},me={class:"mobile"},be={class:"row"},ge={class:"col-4"},fe=["src"],ve={class:"col-5"},we={class:"col-3 text-center"},ye={class:"border-top border-lightBrown p-4 bg-white"},xe={class:"text-brown fs-5 text-end"},ke={class:"row px-2 py-5 fs-5"},Te={class:"mb-5"},Ce={class:"col-md-6 col-12"},Pe={class:"mb-3"},Me={class:"mb-3"},Ve={class:"mb-3"},Se={class:"mb-3"},$e={class:"col-md-6 col-12"},Ne=e("div",{class:"mb-3"},"留言",-1),Be={class:"border border-1 rounded p-2 mb-3 w-100 bg-white",style:{height:"100px"}},Ie={class:"text-end"},Ee={key:0,class:"text-danger"},Le={key:1,class:"text-success"},Ae={key:0,class:"text-end"},je=e("div",null,[e("button",{type:"submit",class:"btn p-0 border-0"},[e("div",{class:"d-flex justify-content-center text-brown"},[e("div",{class:"d-flex align-items-center justify-content-center",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #a2672d"}},[e("a",{class:"text-center bg-brown text-decoration-none text-white m-1 d-block",style:{width:"175px",height:"30px","line-height":"30px"}},"確認付款 ")])])])],-1),Re=[je],Fe={class:"container mt-8 p-0"},Oe=e("h3",{class:"text-center text-brown"},[N(" 猜你喜歡 "),e("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),Ue={id:"swiper"},De={class:"row"},qe=["onClick"],He={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},Ke=["src"],ze={class:"card-body"},Ge={class:"card-title"},Je={key:0,class:"text-gray2 fs-5 card-title text-center"},Qe={key:1,class:"d-flex align-items-center justify-content-center card-title ms-2"},We={class:"text-gray2 fs-5"},Xe={class:"text-brown fs-5 ms-3"},Ye=e("br",null,null,-1),Ze=["onClick"],et={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},tt=e("i",{class:"bi bi-cart-plus"},null,-1);function st(i,c,P,s,M,V){const u=m("VueLoading"),h=m("swiper-slide"),g=m("swiper"),f=m("ToastMessages");return r(),a("div",null,[y(u,{active:s.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:x(()=>[ee]),_:1},8,["active"]),e("div",te,[e("nav",se,[e("ol",oe,[s.order.is_paid===!0?(r(),a("li",re," 訂單完成!感謝您的購買! ")):(r(),a("li",ae," 待付款訂單 "))])])]),e("div",ie,[e("div",ne,[e("table",de,[ce,e("tbody",le,[(r(!0),a(k,null,T(s.order.products,t=>(r(),a("tr",{key:t.id},[e("td",null,[e("div",null,[e("img",{src:t.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,_e),e("div",null,o(t.product.title),1)])]),e("td",null,"$"+o(i.$filters.numberToCurrencyNo(t.product.price)),1),e("td",null,o(t.qty),1),e("td",null,"$"+o(i.$filters.numberToCurrencyNo(t.total)),1)]))),128))]),e("tfoot",ue,[e("tr",null,[e("td",he,[e("div",pe," 訂單金額：$"+o(i.$filters.numberToCurrencyNo(Math.floor(s.order.total)))+"元 ",1)])])])]),e("div",me,[(r(!0),a(k,null,T(s.order.products,t=>(r(),a("div",{class:"border-top border-lightBrown p-3 bg-white",key:t.id},[e("div",be,[e("div",ge,[e("img",{src:t.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,fe)]),e("div",ve,[e("div",null,o(t.product.title),1),e("div",null,"$"+o(i.$filters.numberToCurrencyNo(t.total)),1)]),e("div",we,"x "+o(t.qty),1)])]))),128)),e("div",ye,[e("div",xe," 訂單金額：$"+o(i.$filters.numberToCurrencyNo(Math.floor(s.order.total)))+"元 ",1)])])]),e("form",{onSubmit:c[0]||(c[0]=$((...t)=>s.payOrder&&s.payOrder(...t),["prevent"]))},[e("div",ke,[e("div",Te,"下單時間："+o(i.$filters.date(s.order.create_at)),1),e("div",Ce,[e("div",Pe,"送貨地址："+o(s.order.user.address),1),e("div",Me,"Email："+o(s.order.user.email),1),e("div",Ve,"顧客姓名："+o(s.order.user.name),1),e("div",Se,"電話："+o(s.order.user.tel),1)]),e("div",$e,[Ne,e("div",Be,o(s.order.message),1)]),e("div",Ie,[N(" 付款狀態 "),s.order.is_paid?(r(),a("span",Le,"付款完成")):(r(),a("span",Ee,"尚未付款"))])]),s.order.is_paid===!1?(r(),a("div",Ae,Re)):C("",!0)],32)]),e("div",Fe,[Oe,e("div",Ue,[y(g,{slidesPerView:1,spaceBetween:10,pagination:{clickable:!0},breakpoints:{640:{slidesPerView:2,spaceBetween:20},1024:{slidesPerView:4,spaceBetween:30}},grabCursor:!0,freeMode:!0,modules:s.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:x(()=>[(r(!0),a(k,null,T(s.products,t=>(r(),G(h,{key:t.id},{default:x(()=>[e("div",De,[e("div",{style:{height:"450px"},class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-3 ms-3 p-0",onClick:p=>s.openModal(t)},[t.price!==t.origin_price?(r(),a("span",He,"SALE")):C("",!0),e("img",{src:t.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,Ke),e("div",ze,[e("p",Ge,o(t.title),1),t.price===t.origin_price?(r(),a("div",Je," $"+o(i.$filters.numberToCurrencyNo(t.origin_price)),1)):(r(),a("div",Qe,[e("del",We,"$"+o(i.$filters.numberToCurrencyNo(t.origin_price)),1),e("div",Xe," $"+o(i.$filters.numberToCurrencyNo(t.price)),1)])),Ye,e("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:$(p=>s.addToCart(t.id,1),["stop"])},[t.id===s.status.loadingItem?(r(),a("span",et)):C("",!0),tt],8,Ze)])],8,qe)])]),_:2},1024))),128))]),_:1},8,["modules"])])]),y(f)])}const lt=q(Z,[["render",st]]);export{lt as default};
