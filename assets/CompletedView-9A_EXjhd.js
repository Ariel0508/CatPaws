import{P as R,M as F,K as O,S as U,a as D}from"./pagination--tPxKRbQ.js";import{_ as q,k as H,l as K,g as _,h as z,r as m,o as r,c as a,b as x,w as k,a as e,F as T,m as C,t as o,q as $,d as N,j as b,n as G}from"./index-Uhi6gd-0.js";import{a as f}from"./axios-G2rPRu76.js";import{u as J}from"./cartStore-iyzSn0gZ.js";import{u as Q}from"./toastMessage-g2FpgOZr.js";import{_ as W}from"./ToastMessages-Gr7Bu1fV.js";import{_ as X}from"./loading-bneA9sLj.js";var Y={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Z={setup(){const{VITE_APP_URL:i,VITE_APP_PATH:c}=Y,P=H(),s=K(),M=J(),V=Q(),{pushMessage:u}=V,{getCart:h}=M,g=_({}),v=_(s.params.productId),t=_([]),p=_({loadingItem:""}),d=_(!1),B=()=>{d.value=!0,f.get(`${i}/api/${c}/products`).then(n=>{t.value=n.data.products,d.value=!1}).catch(n=>{alert(n.response.data.message),d.value=!1})},I=n=>{P.push(`/product/${n.id}`).then(()=>{window.scrollTo(0,0)})},E=n=>{p.value.loadingItem=n;const l={product_id:n,qty:1},j=`${i}/api/${c}/cart`;f.post(j,{data:l}).then(A=>{p.value.loadingItem="",u({style:"success",title:"加入購物車",content:A.data.message}),h()})},w=_(s.params.orderId),S=_({user:{}}),y=()=>{const n=`${i}/api/${c}/order/${w.value}`;d.value=!0,f.get(n).then(l=>{S.value=l.data.order,d.value=!1}).catch(l=>{u({style:"danger",title:"錯誤訊息",content:l.response.data.message}),d.value=!1})},L=()=>{const n=`${i}/api/${c}/pay/${w.value}`;d.value=!0,f.post(n).then(()=>{y(),d.value=!1,u({style:"success",title:"付款成功",content:"感謝您的支持"})}).catch(l=>{u({style:"danger",title:"錯誤訊息",content:l.response.data.message}),d.value=!1}),window.scrollTo(0,0)};return y(),z(()=>{B(),h()}),{modules:[R,F,O],products:t,carts:g,openModal:I,addToCart:E,getOrder:y,getCart:h,id:v,status:p,isLoading:d,order:S,orderId:w,payOrder:L}},components:{Swiper:U,SwiperSlide:D,ToastMessages:W}},ee=e("img",{src:X,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1),te={class:"container mt-7 p-0"},se={"aria-label":"breadcrumb"},oe={class:"breadcrumb"},re={key:0,class:"breadcrumb-item active","aria-current":"page"},ae={key:1,class:"breadcrumb-item active","aria-current":"page"},ie={class:"container mt-5"},ne={class:"row"},de={class:"table pc align-middle border-bottom border-lightBrown"},ce=e("thead",null,[e("tr",{class:"text-center"},[e("th",{width:"200"},"商品名稱"),e("th",{width:"120"},"單價"),e("th",{width:"200",class:"text-center"},"數量"),e("th",{width:"200"},"小計")])],-1),le={class:"text-center"},_e=["src"],ue={class:"border-bottom border-white"},he={colspan:"4",class:"text-end pe-8"},pe={class:"text-brown fs-5 text-end mt-3"},me={class:"mobile"},be={class:"row"},fe={class:"col-4 p-0"},ge=["src"],ve={class:"col-8 p-0"},we={class:"mt-3 d-flex justify-content-between"},ye={class:"col-3 text-center"},xe={class:"border-top border-lightBrown p-4 bg-white"},ke={class:"text-brown fs-5 text-end"},Te={class:"row px-2 py-5 fs-6"},Ce={class:"mb-5"},Pe={key:0,class:"text-danger fw-bold"},Me={key:1,class:"text-success fw-bold"},Ve={class:"col-md-6 col-12"},Se={class:"mb-3"},$e={class:"mb-3"},Ne={class:"mb-3"},Be={class:"mb-4"},Ie={class:"mb-3 text-gray2"},Ee={class:"col-md-6 col-12"},Le=e("div",{class:"mb-3"},"留言",-1),je={class:"border border-1 rounded p-2 w-100 bg-white",style:{height:"150px"}},Ae={key:0,class:"text-end"},Re=e("div",null,[e("button",{type:"submit",class:"btn p-0 border-0"},[e("div",{class:"d-flex justify-content-center text-brown"},[e("div",{class:"d-flex align-items-center justify-content-center",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #a2672d"}},[e("a",{class:"text-center bg-brown text-decoration-none text-white m-1 d-block",style:{width:"175px",height:"30px","line-height":"30px"}},"確認付款 ")])])])],-1),Fe=[Re],Oe={key:0,class:"container mt-8 p-0"},Ue=e("h3",{class:"text-center text-brown"},[N(" 猜你喜歡 "),e("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),De={id:"swiper"},qe=["onClick"],He={key:0,class:"position-absolute top-0 start-0 fw-bold fs-6 text-white p-2 bg-brown"},Ke=["src"],ze={class:"card-body"},Ge={class:"card-title"},Je={key:0,class:"text-gray2 fs-5 card-title text-center"},Qe={key:1,class:"d-flex align-items-center justify-content-center card-title ms-2"},We={class:"text-gray2 fs-5"},Xe={class:"text-brown fs-5 ms-3"},Ye=e("br",null,null,-1),Ze=["onClick"],et={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},tt=e("i",{class:"bi bi-cart-plus"},null,-1);function st(i,c,P,s,M,V){const u=m("VueLoading"),h=m("swiper-slide"),g=m("swiper"),v=m("ToastMessages");return r(),a("div",null,[x(u,{active:s.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:k(()=>[ee]),_:1},8,["active"]),e("div",te,[e("nav",se,[e("ol",oe,[s.order.is_paid===!0?(r(),a("li",re," 訂單完成!感謝您的購買! ")):(r(),a("li",ae," 待付款訂單 "))])])]),e("div",ie,[e("div",ne,[e("table",de,[ce,e("tbody",le,[(r(!0),a(T,null,C(s.order.products,t=>(r(),a("tr",{key:t.id},[e("td",null,[e("div",null,[e("img",{src:t.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,_e),e("div",null,o(t.product.title),1)])]),e("td",null,"$"+o(i.$filters.numberToCurrencyNo(t.product.price)),1),e("td",null,o(t.qty),1),e("td",null,"$"+o(i.$filters.numberToCurrencyNo(t.total)),1)]))),128))]),e("tfoot",ue,[e("tr",null,[e("td",he,[e("div",pe," 訂單金額：$"+o(i.$filters.numberToCurrencyNo(Math.floor(s.order.total)))+"元 ",1)])])])]),e("div",me,[(r(!0),a(T,null,C(s.order.products,t=>(r(),a("div",{class:"border-top border-lightBrown p-3 bg-white",key:t.id},[e("div",be,[e("div",fe,[e("img",{src:t.product.imageUrl,class:"img-fluid object-fit-cover",style:{width:"80px",height:"80px"},alt:""},null,8,ge)]),e("div",ve,[e("div",null,o(t.product.title),1),e("div",we,[e("div",null,"$"+o(i.$filters.numberToCurrencyNo(t.total)),1),e("div",ye,"x "+o(t.qty),1)])])])]))),128)),e("div",xe,[e("div",ke," 訂單金額：$"+o(i.$filters.numberToCurrencyNo(Math.floor(s.order.total)))+"元 ",1)])])]),e("form",{onSubmit:c[0]||(c[0]=$((...t)=>s.payOrder&&s.payOrder(...t),["prevent"]))},[e("div",Te,[e("div",Ce,[N(" 付款狀態 "),s.order.is_paid?(r(),a("span",Me,"付款完成")):(r(),a("span",Pe,"尚未付款"))]),e("div",Ve,[e("div",Se,"送貨地址："+o(s.order.user.address),1),e("div",$e,"Email："+o(s.order.user.email),1),e("div",Ne,"顧客姓名："+o(s.order.user.name),1),e("div",Be,"電話："+o(s.order.user.tel),1),e("div",Ie," 下單時間："+o(i.$filters.date(s.order.create_at)),1)]),e("div",Ee,[Le,e("div",je,o(s.order.message),1)])]),s.order.is_paid===!1?(r(),a("div",Ae,Fe)):b("",!0)],32)]),s.order.is_paid===!0?(r(),a("div",Oe,[Ue,e("div",De,[x(g,{slidesPerView:1,spaceBetween:10,pagination:{clickable:!0},breakpoints:{640:{slidesPerView:2,spaceBetween:20},1024:{slidesPerView:4,spaceBetween:30}},grabCursor:!0,freeMode:!0,modules:s.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:k(()=>[(r(!0),a(T,null,C(s.products,t=>(r(),G(h,{key:t.id},{default:k(()=>[e("div",{style:{height:"450px"},class:"card shadow-sm rounded-lg border-0 position-relative mb-5",onClick:p=>s.openModal(t)},[t.price!==t.origin_price?(r(),a("span",He,"SALE")):b("",!0),e("img",{src:t.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,Ke),e("div",ze,[e("p",Ge,o(t.title),1),t.price===t.origin_price?(r(),a("div",Je," $"+o(i.$filters.numberToCurrencyNo(t.origin_price)),1)):(r(),a("div",Qe,[e("del",We,"$"+o(i.$filters.numberToCurrencyNo(t.origin_price)),1),e("div",Xe," $"+o(i.$filters.numberToCurrencyNo(t.price)),1)])),Ye,e("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:$(p=>s.addToCart(t.id,1),["stop"])},[t.id===s.status.loadingItem?(r(),a("span",et)):b("",!0),tt],8,Ze)])],8,qe)]),_:2},1024))),128))]),_:1},8,["modules"])])])):b("",!0),x(v)])}const lt=q(Z,[["render",st]]);export{lt as default};
