import{a as v}from"./axios-G2rPRu76.js";import{_ as N,k as U,l as j,f as c,s as F,g as H,r as y,o as n,c as i,a as t,b as u,w as P,F as x,m as $,d as k,t as m,j as I,q as O}from"./index-jjd0GBJI.js";import{u as z}from"./cartStore-izFotvQE.js";import{_ as G}from"./PaginationComponent-rjKybEjp.js";import{u as J}from"./toastMessage-T-vDHxpX.js";import{_ as K}from"./ToastMessages-LWYl60w5.js";var Q={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:w,VITE_APP_PATH:T}=Q,W={setup(){const C=z(),{getCart:l}=C,E=J(),{pushMessage:e}=E,M=U(),p=j(),d=c(p.params.productId),r=c([]),_=c({loadingItem:""}),s=c([]),h=c(0),R=c(0),A=c(["時尚配件","休閒娛樂","生活用品"]),b=()=>{const{category:o=""}=p.query,a=`${w}/api/${T}/products?category=${o}`;v.get(a).then(g=>{r.value=g.data.products,f.value=g.data.pagination})},S=()=>{r.value.sort((o,a)=>o.price-a.price)},L=()=>{r.value.sort((o,a)=>a.price-o.price)},D=o=>{M.push(`/product/${o.id}`).then(()=>{window.scrollTo(0,0)})},f=c({}),V=(o=1)=>{v.get(`${w}/api/${T}/products?page=${o}`).then(a=>{r.value=a.data.products,f.value=a.data.pagination}).catch(a=>{alert(a.response.data.message)})},q=o=>{_.value.loadingItem=o;const a={product_id:o,qty:1},g=`${w}/api/${T}/cart`;v.post(g,{data:a}).then(B=>{_.value.loadingItem="",e({style:"success",title:"加入購物車",content:B.data.message}),l()})};return F(()=>p.query,()=>{b()}),H(()=>{b(),V()}),{id:d,products:r,categories:A,status:_,getProducts:b,addToCart:q,openModal:D,heightPrice:L,lowPrice:S,getData:V,pagination:f,carts:s,finalTotal:h,total:R}},components:{Pagination:G,ToastMessages:K}},X={id:"app"},Y={class:"container mt-8 p-0"},Z={"aria-label":"breadcrumb"},tt={class:"breadcrumb"},st={class:"breadcrumb-item",to:"/"},et=t("li",{class:"breadcrumb-item active","aria-current":"page"},"產品",-1),ot={class:"row mt-5"},at={class:"col-md-3"},nt={class:"list-unstyled mb-2"},it={class:"fs-4 text-gray2 mb-2 list-unstyled"},ct=t("div",{class:"fs-4 text-gray2 mt-3 mb-2"},"篩選條件",-1),rt=t("br",null,null,-1),lt={class:"col-md-9"},dt={class:"row mb-5"},_t=["onClick"],ut={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown"},mt=["src"],pt={class:"card-body"},gt={class:"card-title"},ht={key:0,class:"text-gray2 fs-5 card-title"},bt={key:1,class:"d-flex align-items-center card-title ms-2"},ft={class:"text-gray2 fs-5"},vt={class:"text-brown fs-4 ms-3"},yt=["onClick"],Pt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},xt=t("i",{class:"bi bi-cart-plus"},null,-1),kt={class:"d-flex justify-content-end"};function wt(C,l,E,e,M,p){const d=y("RouterLink"),r=y("Pagination"),_=y("ToastMessages");return n(),i(x,null,[t("div",X,[t("div",Y,[t("nav",Z,[t("ol",tt,[t("li",st,[u(d,{class:"text-black text-decoration-none",to:"/"},{default:P(()=>[k("首頁")]),_:1})]),et])]),t("div",ot,[t("div",at,[t("ul",nt,[t("li",it,[u(d,{class:"text-decoration-none text-gray2",to:{path:"/products",query:{category:""}}},{default:P(()=>[k(" 全部產品 ")]),_:1})]),(n(!0),i(x,null,$(e.categories,s=>(n(),i("li",{key:s,class:"fs-6 mb-2 list-unstyled"},[u(d,{class:"text-decoration-none text-gray2",to:`/products?category=${s}`},{default:P(()=>[k(m(s),1)]),_:2},1032,["to"])]))),128))]),ct,t("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:l[0]||(l[0]=(...s)=>e.heightPrice&&e.heightPrice(...s))},"價格高到低"),rt,t("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:l[1]||(l[1]=(...s)=>e.lowPrice&&e.lowPrice(...s))},"價格低到高")]),t("div",lt,[t("div",dt,[(n(!0),i(x,null,$(e.products,s=>(n(),i("div",{class:"col-md-4",key:s.id},[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5",onClick:h=>e.openModal(s)},[s.price!==s.origin_price?(n(),i("span",ut,"SALE")):I("",!0),t("img",{src:s.imageUrl,class:"card-img-top object-fit-cover",style:{height:"300px"},alt:"productPicture"},null,8,mt),t("div",pt,[t("p",gt,m(s.title),1),s.price===s.origin_price?(n(),i("div",ht," $"+m(s.origin_price),1)):(n(),i("div",bt,[t("del",ft,"$"+m(s.origin_price),1),t("div",vt,"$"+m(s.price),1)])),t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:O(h=>e.addToCart(s.id,1),["stop"])},[s.id===e.status.loadingItem?(n(),i("span",Pt)):I("",!0),xt],8,yt)])],8,_t)]))),128)),t("div",kt,[u(r,{pages:e.pagination,onEmitPages:e.getData},null,8,["pages","onEmitPages"])])])])])])]),u(_)],64)}const It=N(W,[["render",wt]]);export{It as default};
