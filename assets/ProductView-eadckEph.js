import{a as B}from"./axios-G2rPRu76.js";import{x as K,y as J,u as R,f as i,v as U,_ as N,o as w,c as y,a as e,z as $,A as H,i as W,F as O,p as q,n as Q,k as Z,l as ee,g as te,m as oe,r as V,b as T,w as I,t as P,B as se,j,d as L,q as ne,s as ae}from"./index-gh1Wuwja.js";import{u as ie}from"./cartStore-hNeT1rAu.js";import{u as le}from"./toastMessage-gtw7JEM3.js";import{_ as ce}from"./ToastMessages-IWzdNRXF.js";import{P as re,N as de,S as ue,a as me}from"./pagination-WlznZS4s.js";import{M as pe,K as _e}from"./mousewheel-m2Jvx6FX.js";function ve(o){return K()?(J(o),!0):!1}function z(o){return typeof o=="function"?o():R(o)}const fe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ge=Object.prototype.toString,he=o=>ge.call(o)==="[object Object]",be=()=>{};function F(o){var n;const p=z(o);return(n=p==null?void 0:p.$el)!=null?n:p}const D=fe?window:void 0;function A(...o){let n,p,t,d;if(typeof o[0]=="string"||Array.isArray(o[0])?([p,t,d]=o,n=D):[n,p,t,d]=o,!n)return be;Array.isArray(p)||(p=[p]),Array.isArray(t)||(t=[t]);const l=[],r=()=>{l.forEach(c=>c()),l.length=0},g=(c,s,v,f)=>(c.addEventListener(s,v,f),()=>c.removeEventListener(s,v,f)),u=U(()=>[F(n),z(d)],([c,s])=>{if(r(),!c)return;const v=he(s)?{...s}:s;l.push(...p.flatMap(f=>t.map(h=>g(c,f,h,v))))},{immediate:!0,flush:"post"}),_=()=>{u(),r()};return ve(_),_}const we={page:o=>[o.pageX,o.pageY],client:o=>[o.clientX,o.clientY],screen:o=>[o.screenX,o.screenY],movement:o=>o instanceof Touch?null:[o.movementX,o.movementY]};function ye(o={}){const{type:n="page",touch:p=!0,resetOnTouchEnds:t=!1,initialValue:d={x:0,y:0},window:l=D,target:r=l,scroll:g=!0,eventFilter:u}=o;let _=null;const c=i(d.x),s=i(d.y),v=i(null),f=typeof n=="function"?n:we[n],h=a=>{const b=f(a);_=a,b&&([c.value,s.value]=b,v.value="mouse")},x=a=>{if(a.touches.length>0){const b=f(a.touches[0]);b&&([c.value,s.value]=b,v.value="touch")}},k=()=>{if(!_||!l)return;const a=f(_);_ instanceof MouseEvent&&a&&(c.value=a[0]+l.scrollX,s.value=a[1]+l.scrollY)},C=()=>{c.value=d.x,s.value=d.y},E=u?a=>u(()=>h(a),{}):a=>h(a),S=u?a=>u(()=>x(a),{}):a=>x(a),M=u?()=>u(()=>k(),{}):()=>k();if(r){const a={passive:!0};A(r,["mousemove","dragover"],E,a),p&&n!=="movement"&&(A(r,["touchstart","touchmove"],S,a),t&&A(r,"touchend",C,a)),g&&n==="page"&&A(l,"scroll",M,{passive:!0})}return{x:c,y:s,sourceType:v}}function xe(o,n={}){const{handleOutside:p=!0,window:t=D}=n,d=n.type||"page",{x:l,y:r,sourceType:g}=ye(n),u=i(o??(t==null?void 0:t.document.body)),_=i(0),c=i(0),s=i(0),v=i(0),f=i(0),h=i(0),x=i(!0);let k=()=>{};return t&&(k=U([u,l,r],()=>{const C=F(u);if(!C)return;const{left:E,top:S,width:M,height:a}=C.getBoundingClientRect();s.value=E+(d==="page"?t.pageXOffset:0),v.value=S+(d==="page"?t.pageYOffset:0),f.value=a,h.value=M;const b=l.value-s.value,m=r.value-v.value;x.value=M===0||a===0||b<0||m<0||b>M||m>a,(p||!x.value)&&(_.value=b,c.value=m)},{immediate:!0}),A(document,"mouseleave",()=>{x.value=!0})),{x:l,y:r,sourceType:g,elementX:_,elementY:c,elementPositionX:s,elementPositionY:v,elementHeight:f,elementWidth:h,isOutside:x,stop:k}}const ke={class:"goods-image flex-column d-flex p-0 m-2"},Ce=["src"],Pe={class:"small d-flex row px-3"},Se=["onMouseenter"],Me=["src"],Te={__name:"ImageComponentView",props:{imageList:{type:Array,default:()=>[]}},setup(o){const n=i(0),p=s=>{n.value=s},t=i(null),{elementX:d,elementY:l,isOutside:r}=xe(t),g=i(0),u=i(0),_=i(0),c=i(0);return U([d,l,r],()=>{r.value||(d.value>100&&d.value<300&&(g.value=d.value-100),l.value>100&&l.value<300&&(u.value=l.value-100),d.value<100&&(g.value=0),d.value>300&&(g.value=200),l.value<100&&(u.value=0),l.value>300&&(u.value=200),_.value=-g.value*2,c.value=-u.value*2)}),(s,v)=>(w(),y("div",ke,[e("div",{class:"middle",ref_key:"target",ref:t},[e("img",{src:o.imageList[n.value],class:"img-fluid object-fit-cover w-100",style:{height:"400px"},alt:""},null,8,Ce),$(e("div",{class:"layer",style:W({left:`${g.value}px`,top:`${u.value}px`})},null,4),[[H,!R(r)]])],512),e("ul",Pe,[(w(!0),y(O,null,q(o.imageList,(f,h)=>(w(),y("li",{class:Q(["list-unstyled p-0 me-2",{active:h===n.value}]),key:h,onMouseenter:x=>p(h)},[e("img",{src:f,class:"img-fluid object-fit-cover w-100 h-100",alt:""},null,8,Me)],42,Se))),128))]),$(e("div",{class:"large",style:W([{backgroundImage:`url(${o.imageList[n.value]})`,backgroundPositionX:`${_.value}px`,backgroundPositionY:`${c.value}px`}])},null,4),[[H,!R(r)]])]))}},Ee=N(Te,[["__scopeId","data-v-440f5633"]]);var Ve={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Ie={setup(){const{VITE_APP_URL:o,VITE_APP_PATH:n}=Ve,p=Z(),t=ee(),d=ie(),{getCart:l}=d,r=le(),{pushMessage:g}=r,u=i(t.params.productId),_=i([]),c=i({loadingItem:""}),s=()=>{B.get(`${o}/api/${n}/products`).then(m=>{_.value=m.data.products}).catch(m=>{alert(m.response.data.message)})},v=m=>{k.value=m,C(),p.push(`/product/${m.id}`).then(()=>{window.scrollTo(0,0)})},f=i({}),h=i([]),x=i(1),k=i(t.params),C=()=>{B.get(`${o}/api/${n}/product/${k.value.id}`).then(m=>{f.value=m.data.product,h.value=m.data.product.imagesUrl,console.log(m.data.product.imagesUrl),console.log(m.data.product)})},E=i(["時尚配件","休閒娛樂","生活用品"]),S=()=>{const{category:m=""}=t.query,X=`${o}/api/${n}/products?category=${m}`;B.get(X).then(Y=>{f.value=Y.data.products})},M=m=>{c.value.loadingItem=m;const X={product_id:m,qty:x.value},Y=`${o}/api/${n}/cart`;B.post(Y,{data:X}).then(G=>{c.value.loadingItem="",g({style:"success",title:"加入購物車",content:G.data.message}),l()})};C();const a=i(4),b=()=>{window.innerWidth<=767?a.value=2:a.value=4};return U(()=>t.query,()=>{S(),C(),l()}),te(()=>{C(),l(),S(),s(),b(),window.addEventListener("resize",b)}),oe(()=>{window.removeEventListener("resize",b)}),{modules:[re,de,pe,_e],products:_,openModal:v,addToCart:M,product:f,imagesUrl:h,qty:x,categories:E,getProducts:S,gProduct:k,id:u,status:c,slidesPerView:a}},components:{Swiper:ue,SwiperSlide:me,ImageComponent:Ee,ToastMessages:ce}},Le={id:"app"},Ae={class:"container mt-8"},Be={"aria-label":"breadcrumb"},Oe={class:"breadcrumb"},Ue={class:"breadcrumb-item",to:"/"},Xe={class:"breadcrumb-item"},Ye={class:"breadcrumb-item active","aria-current":"page"},je={class:"row mt-5"},Re=e("div",{class:"col-md-2"},null,-1),$e={class:"col-md-10"},qe={class:"row"},De={class:"col-md-6 col-12"},He={class:"row"},We={class:"col-md-6 col-12 d-flex flex-column justify-content-between"},Ne={class:"fs-4 mb-4"},ze={class:"mb-4"},Fe={key:0,class:"text-gray2 fs-5"},Ge={key:1,class:"d-flex align-items-center"},Ke={class:"text-gray2 fs-5"},Je={class:"text-brown fs-4 ms-3"},Qe={class:"mb-5"},Ze=e("div",{class:"fs-6 mb-2"},"商品內容:",-1),et={class:"input-group w-50 mb-4"},tt=["disabled"],ot={class:"row"},st={class:"d-flex justify-content-center align-items-center mx-2 p-0 mt-3",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #e9b888"}},nt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},at={class:"d-flex justify-content-center align-items-center mx-2 p-0 mt-3",style:{width:"185px",height:"40px",background:"#ffffff",border:"1px solid #e9b888"}},it={class:"row mt-8"},lt=e("div",{class:"fs-6 mb-4"},"商品詳情:",-1),ct={style:{"white-space":"pre-wrap"}},rt={class:"list-unstyled mb-3"},dt=["src"],ut={class:"container mt-8"},mt=e("h3",{class:"text-center text-brown"},[L(" 猜你喜歡 "),e("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),pt={id:"swiper"},_t={class:"row"},vt=["onClick"],ft={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},gt=["src"],ht={class:"card-body"},bt={class:"card-title"},wt={class:"card-title text-brown"},yt=["onClick"],xt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},kt=e("i",{class:"bi bi-cart-plus"},null,-1);function Ct(o,n,p,t,d,l){const r=V("RouterLink"),g=V("ImageComponent"),u=V("swiper-slide"),_=V("swiper"),c=V("ToastMessages");return w(),y(O,null,[e("div",Le,[e("div",Ae,[e("nav",Be,[e("ol",Oe,[e("li",Ue,[T(r,{class:"text-black text-decoration-none",to:"/"},{default:I(()=>[L("首頁")]),_:1})]),e("li",Xe,[T(r,{class:"text-black text-decoration-none",to:"/products"},{default:I(()=>[L("產品")]),_:1})]),e("li",Ye,P(t.product.category),1)])]),e("div",je,[Re,e("div",$e,[e("div",qe,[e("div",De,[e("div",He,[T(g,{imageList:t.imagesUrl,class:"mb-8"},null,8,["imageList"])])]),e("div",We,[e("div",Ne,P(t.product.title),1),e("div",ze,[t.product.price===t.product.origin_price?(w(),y("div",Fe," $"+P(t.product.origin_price),1)):(w(),y("div",Ge,[e("del",Ke,"$"+P(t.product.origin_price),1),e("div",Je,"$"+P(t.product.price),1)]))]),e("div",Qe,[Ze,e("div",null,P(t.product.content),1)]),e("div",et,[e("button",{type:"button",class:"btn btn-outline-lightBrown",disabled:t.qty===1,onClick:n[0]||(n[0]=s=>t.qty--)}," - ",8,tt),$(e("input",{"onUpdate:modelValue":n[1]||(n[1]=s=>t.qty=s),type:"number",min:"1",max:"20",class:"form-control text-center","aria-label":"Dollar amount (with dot and two decimal places)",readonly:""},null,512),[[se,t.qty,void 0,{number:!0}]]),e("button",{type:"button",class:"btn btn-outline-lightBrown",onClick:n[2]||(n[2]=s=>t.qty++)}," + ")]),e("div",ot,[e("div",st,[e("button",{type:"button",class:"loginbtn text-center bg-lightBrown border-0",onClick:n[3]||(n[3]=s=>t.addToCart(t.product.id))},[t.product.id===t.status.loadingItem?(w(),y("span",nt)):j("",!0),L(" 加入購物車 ")])]),e("div",at,[T(r,{class:"loginbtn text-center bg-brown d-block",to:"/cart",onClick:n[4]||(n[4]=s=>t.addToCart(t.product.id))},{default:I(()=>[L("立即購買")]),_:1})])])])]),e("div",it,[lt,e("div",ct,P(t.product.description),1)]),(w(!0),y(O,null,q(t.imagesUrl,s=>(w(),y("div",{class:"row mt-5",key:s},[e("li",rt,[e("img",{src:s,class:"w-50",alt:""},null,8,dt)])]))),128))])]),e("div",ut,[mt,e("div",pt,[T(_,{slidesPerView:t.slidesPerView,grabCursor:!0,spaceBetween:30,pagination:{clickable:!0},modules:t.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:I(()=>[(w(!0),y(O,null,q(t.products,s=>(w(),ne(u,{key:s.id},{default:I(()=>[e("div",_t,[e("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5 col-md-12 col-12 p-0",onClick:v=>t.openModal(s)},[s.price!==s.origin_price?(w(),y("span",ft,"SALE")):j("",!0),e("img",{src:s.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,gt),e("div",ht,[e("p",bt,P(s.title),1),e("p",wt,"$ "+P(s.price),1),e("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:ae(v=>t.addToCart(s.id,1),["stop"])},[s.id===t.status.loadingItem?(w(),y("span",xt)):j("",!0),kt],8,yt)])],8,vt)])]),_:2},1024))),128))]),_:1},8,["slidesPerView","modules"])])])])]),T(c)],64)}const Lt=N(Ie,[["render",Ct]]);export{Lt as default};
