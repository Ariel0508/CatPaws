import{a as S}from"./axios-G2rPRu76.js";import{_ as $,k as q,l as D,g as r,h as j,r as v,o as l,c as d,a as e,b as f,w as T,F as L,m as B,d as U,j as I,t as m,q as H,p as O,f as z}from"./index-08FGxrZr.js";import{u as G}from"./cartStore-1EokPbyD.js";import{u as J}from"./toastMessage-W4zx11Vp.js";import{_ as K}from"./ToastMessages-quBXMO8c.js";import{_ as Q}from"./loading-bneA9sLj.js";var W={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:V,VITE_APP_PATH:M}=W,X={setup(){const a=G(),{getCart:n}=a,w=J(),{pushMessage:s}=w,y=q(),P=D(),h=r(P.params.productId),_=r([]),u=r({loadingItem:""}),t=r(!1),g=r([]),E=r(0),R=r(0),C=()=>{_.value.sort((o,c)=>o.price-c.price),document.querySelector(".lowPrice").classList.add("price-active"),document.querySelector(".heightPrice").classList.remove("price-active")},k=()=>{_.value.sort((o,c)=>c.price-o.price),document.querySelector(".heightPrice").classList.add("price-active"),document.querySelector(".lowPrice").classList.remove("price-active")},A=o=>{y.push(`/product/${o.id}`).then(()=>{window.scrollTo(0,0)})},x=()=>{const o=`${V}/api/${M}/products/all`;t.value=!0,S.get(o).then(c=>{const b=c.data.products.filter(p=>p.price<p.origin_price);_.value=b,t.value=!1}).catch(c=>{alert(c.response.data.message)})},F=o=>{u.value.loadingItem=o;const c={product_id:o,qty:1},b=`${V}/api/${M}/cart`;S.post(b,{data:c}).then(p=>{u.value.loadingItem="",s({style:"success",title:"加入購物車",content:p.data.message}),n()})},N=()=>{const o=event.target.value;o==="high"?k():o==="low"&&C()};return j(()=>{x()}),{id:h,products:_,status:u,isLoading:t,addToCart:F,openModal:A,heightPrice:k,lowPrice:C,carts:g,finalTotal:E,total:R,getProducts:x,selectChange:N}},components:{ToastMessages:K}},i=a=>(O("data-v-02c9b865"),a=a(),z(),a),Y={id:"app"},Z=i(()=>e("img",{src:Q,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1)),ee={class:"container mt-7 p-0"},te={"aria-label":"breadcrumb"},se={class:"breadcrumb"},oe={class:"breadcrumb-item",to:"/"},ie=i(()=>e("li",{class:"breadcrumb-item active","aria-current":"page"},"特價商品",-1)),ae={class:"row mt-7"},ce={class:"col-md-3"},ne={class:"mSale"},re={class:"d-flex justify-content-end mb-5"},le=i(()=>e("option",{selected:""},"價格",-1)),de=i(()=>e("option",{value:"high"},"價格高到低",-1)),_e=i(()=>e("option",{value:"low"},"價格低到高",-1)),ue=[le,de,_e],pe={class:"pSale"},me=i(()=>e("div",{class:"fs-4 text-gray2 mb-2"},"篩選條件",-1)),he=i(()=>e("span",{class:"heightPrice"},"價格高到低",-1)),ge=[he],be=i(()=>e("br",null,null,-1)),ve=i(()=>e("span",{class:"lowPrice"},"價格低到高",-1)),fe=[ve],we={class:"col-md-9"},ye={class:"row"},Pe=["onClick"],Ce={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown"},ke=["src"],xe={class:"card-body"},Se={class:"card-title text-center rwdFont"},Te={key:0,class:"text-gray2 fs-5 card-title"},Le={key:1,class:"d-flex justify-content-center align-items-center card-title ms-2"},Ie={class:"text-gray2 fs-5"},Ve={class:"text-brown fs-5 ms-3"},Me=i(()=>e("br",null,null,-1)),Ee=["onClick"],Re={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Ae=i(()=>e("i",{class:"bi bi-cart-plus"},null,-1));function Fe(a,n,w,s,y,P){const h=v("VueLoading"),_=v("RouterLink"),u=v("ToastMessages");return l(),d(L,null,[e("div",Y,[f(h,{active:s.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:T(()=>[Z]),_:1},8,["active"]),e("div",ee,[e("nav",te,[e("ol",se,[e("li",oe,[f(_,{class:"text-black text-decoration-none",to:"/"},{default:T(()=>[U("首頁")]),_:1})]),ie])]),e("div",ae,[e("div",ce,[e("div",ne,[e("div",re,[e("select",{class:"p-1 text-gray2","aria-label":"Default select example",onChange:n[0]||(n[0]=(...t)=>s.selectChange&&s.selectChange(...t))},ue,32)])]),e("div",pe,[me,e("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:n[1]||(n[1]=(...t)=>s.heightPrice&&s.heightPrice(...t))},ge),be,e("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:n[2]||(n[2]=(...t)=>s.lowPrice&&s.lowPrice(...t))},fe)])]),e("div",we,[e("div",ye,[(l(!0),d(L,null,B(s.products,t=>(l(),d("div",{class:"col-md-4 col-6",key:t.id},[e("div",{class:"card shadow-sm rounded-lg border-0 position-relative mb-5",onClick:g=>s.openModal(t)},[t.price!==t.origin_price?(l(),d("span",Ce,"SALE")):I("",!0),e("img",{src:t.imageUrl,class:"card-img-top object-fit-cover w-100 rwdImg",alt:"productPicture"},null,8,ke),e("div",xe,[e("p",Se,m(t.title),1),t.price===t.origin_price?(l(),d("div",Te," $"+m(a.$filters.numberToCurrencyNo(t.origin_price)),1)):(l(),d("div",Le,[e("del",Ie,"$"+m(a.$filters.numberToCurrencyNo(t.origin_price)),1),e("div",Ve," $"+m(a.$filters.numberToCurrencyNo(t.price)),1)])),Me,e("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:H(g=>s.addToCart(t.id,1),["stop"])},[t.id===s.status.loadingItem?(l(),d("span",Re)):I("",!0),Ae],8,Ee)])],8,Pe)]))),128))])])])])]),f(u)],64)}const Ue=$(X,[["render",Fe],["__scopeId","data-v-02c9b865"]]);export{Ue as default};
