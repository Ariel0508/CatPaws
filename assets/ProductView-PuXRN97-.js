import{a as B}from"./axios-G2rPRu76.js";import{x as J,y as Q,u as R,f as r,q as O,_ as F,o as b,c as y,a as t,z as U,A as H,B as W,F as j,m as q,C as Z,j as ee,k as te,g as se,l as oe,r as E,b as L,w as V,t as k,D as ne,i as Y,d as $,n as ae,p as ie}from"./index-CP4Mrudi.js";import{u as re}from"./cartStore-ayfO5okx.js";import{u as le}from"./toastMessage-Cq4jzKej.js";import{_ as ce}from"./ToastMessages-wclNYnoh.js";import{P as de,N as ue,S as me,a as pe}from"./pagination-XVC7OyxO.js";import{M as ve,K as _e}from"./mousewheel-21ZvAEmy.js";import{_ as fe}from"./loading-bneA9sLj.js";function ge(s){return J()?(Q(s),!0):!1}function z(s){return typeof s=="function"?s():R(s)}const be=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const he=Object.prototype.toString,ye=s=>he.call(s)==="[object Object]",we=()=>{};function G(s){var o;const p=z(s);return(o=p==null?void 0:p.$el)!=null?o:p}const D=be?window:void 0;function A(...s){let o,p,e,d;if(typeof s[0]=="string"||Array.isArray(s[0])?([p,e,d]=s,o=D):[o,p,e,d]=s,!o)return we;Array.isArray(p)||(p=[p]),Array.isArray(e)||(e=[e]);const l=[],m=()=>{l.forEach(c=>c()),l.length=0},_=(c,a,n,f)=>(c.addEventListener(a,n,f),()=>c.removeEventListener(a,n,f)),u=O(()=>[G(o),z(d)],([c,a])=>{if(m(),!c)return;const n=ye(a)?{...a}:a;l.push(...p.flatMap(f=>e.map(g=>_(c,f,g,n))))},{immediate:!0,flush:"post"}),v=()=>{u(),m()};return ge(v),v}const xe={page:s=>[s.pageX,s.pageY],client:s=>[s.clientX,s.clientY],screen:s=>[s.screenX,s.screenY],movement:s=>s instanceof Touch?null:[s.movementX,s.movementY]};function ke(s={}){const{type:o="page",touch:p=!0,resetOnTouchEnds:e=!1,initialValue:d={x:0,y:0},window:l=D,target:m=l,scroll:_=!0,eventFilter:u}=s;let v=null;const c=r(d.x),a=r(d.y),n=r(null),f=typeof o=="function"?o:xe[o],g=i=>{const w=f(i);v=i,w&&([c.value,a.value]=w,n.value="mouse")},x=i=>{if(i.touches.length>0){const w=f(i.touches[0]);w&&([c.value,a.value]=w,n.value="touch")}},T=()=>{if(!v||!l)return;const i=f(v);v instanceof MouseEvent&&i&&(c.value=i[0]+l.scrollX,a.value=i[1]+l.scrollY)},P=()=>{c.value=d.x,a.value=d.y},M=u?i=>u(()=>g(i),{}):i=>g(i),I=u?i=>u(()=>x(i),{}):i=>x(i),C=u?()=>u(()=>T(),{}):()=>T();if(m){const i={passive:!0};A(m,["mousemove","dragover"],M,i),p&&o!=="movement"&&(A(m,["touchstart","touchmove"],I,i),e&&A(m,"touchend",P,i)),_&&o==="page"&&A(l,"scroll",C,{passive:!0})}return{x:c,y:a,sourceType:n}}function Ce(s,o={}){const{handleOutside:p=!0,window:e=D}=o,d=o.type||"page",{x:l,y:m,sourceType:_}=ke(o),u=r(s??(e==null?void 0:e.document.body)),v=r(0),c=r(0),a=r(0),n=r(0),f=r(0),g=r(0),x=r(!0);let T=()=>{};return e&&(T=O([u,l,m],()=>{const P=G(u);if(!P)return;const{left:M,top:I,width:C,height:i}=P.getBoundingClientRect();a.value=M+(d==="page"?e.pageXOffset:0),n.value=I+(d==="page"?e.pageYOffset:0),f.value=i,g.value=C;const w=l.value-a.value,S=m.value-n.value;x.value=C===0||i===0||w<0||S<0||w>C||S>i,(p||!x.value)&&(v.value=w,c.value=S)},{immediate:!0}),A(document,"mouseleave",()=>{x.value=!0})),{x:l,y:m,sourceType:_,elementX:v,elementY:c,elementPositionX:a,elementPositionY:n,elementHeight:f,elementWidth:g,isOutside:x,stop:T}}const Te={class:"goods-image flex-column d-flex p-0"},Pe=["src"],Me={class:"small d-flex px-0 m-0"},Se=["onMouseenter"],Le=["src"],Ee={__name:"ImageComponentView",props:{imageList:{type:Array,default:()=>[]}},setup(s){const o=r(0),p=a=>{o.value=a},e=r(null),{elementX:d,elementY:l,isOutside:m}=Ce(e),_=r(0),u=r(0),v=r(0),c=r(0);return O([d,l,m],()=>{m.value||(d.value>125&&d.value<325&&(_.value=d.value-125),l.value>125&&l.value<325&&(u.value=l.value-125),d.value<125&&(_.value=0),d.value>325&&(_.value=225),l.value<125&&(u.value=0),l.value>325&&(u.value=225),v.value=-_.value*2,c.value=-u.value*2)}),(a,n)=>(b(),y("div",Te,[t("div",{class:"middle",ref_key:"target",ref:e},[t("img",{src:s.imageList[o.value],class:"img-fluid object-fit-cover w-100",alt:""},null,8,Pe),U(t("div",{class:"layer",style:W({left:`${_.value}px`,top:`${u.value}px`})},null,4),[[H,!R(m)]])],512),t("ul",Me,[(b(!0),y(j,null,q(s.imageList,(f,g)=>(b(),y("li",{class:Z(["list-unstyled p-0 me-2",{active:g===o.value}]),key:g,onMouseenter:x=>p(g)},[t("img",{src:f,class:"img-fluid object-fit-cover w-100 h-100",alt:""},null,8,Le)],42,Se))),128))]),U(t("div",{class:"large",style:W([{backgroundImage:`url(${s.imageList[o.value]})`,backgroundPositionX:`${v.value}px`,backgroundPositionY:`${c.value}px`}])},null,4),[[H,!R(m)]])]))}},Ve=F(Ee,[["__scopeId","data-v-006988ee"]]);var Ie={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const $e={setup(){const{VITE_APP_URL:s,VITE_APP_PATH:o}=Ie,p=ee(),e=te(),d=re(),{getCart:l}=d,m=le(),{pushMessage:_}=m,u=r(e.params.productId),v=r([]),c=r({loadingItem:""}),a=r(!1),n=()=>{a.value=!0,B.get(`${s}/api/${o}/products`).then(h=>{v.value=h.data.products,a.value=!1}).catch(h=>{alert(h.response.data.message),a.value=!1})},f=h=>{P.value=h,M(),p.push(`/product/${h.id}`).then(()=>{window.scrollTo(0,0)})},g=r({}),x=r([]),T=r(1),P=r(e.params),M=()=>{a.value=!0,B.get(`${s}/api/${o}/product/${P.value.id}`).then(h=>{g.value=h.data.product,x.value=h.data.product.imagesUrl,a.value=!1})},I=r(["時尚配件","休閒娛樂","生活用品"]),C=()=>{const{category:h=""}=e.query,N=`${s}/api/${o}/products?category=${h}`;a.value=!0,B.get(N).then(X=>{g.value=X.data.products,a.value=!1})},i=h=>{c.value.loadingItem=h;const N={product_id:h,qty:T.value},X=`${s}/api/${o}/cart`;B.post(X,{data:N}).then(K=>{c.value.loadingItem="",_({style:"success",title:"加入購物車",content:K.data.message}),l(),window.scrollTo(0,0)})};M();const w=r(4),S=()=>{window.innerWidth<=767?w.value=1:w.value=4};return O(()=>e.query,()=>{C(),M(),l()}),se(()=>{M(),l(),C(),n(),S(),window.addEventListener("resize",S)}),oe(()=>{window.removeEventListener("resize",S)}),{modules:[de,ue,ve,_e],products:v,openModal:f,addToCart:i,product:g,imagesUrl:x,qty:T,categories:I,getProducts:C,gProduct:P,id:u,status:c,slidesPerView:w,isLoading:a}},components:{Swiper:me,SwiperSlide:pe,ImageComponent:Ve,ToastMessages:ce}},Ae={id:"app"},Be=t("img",{src:fe,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1),je={class:"container mt-7"},Oe={"aria-label":"breadcrumb"},Ne={class:"breadcrumb"},Xe={class:"breadcrumb-item",to:"/"},Ye={class:"breadcrumb-item"},Re={class:"breadcrumb-item active","aria-current":"page"},Ue={class:"row mt-5"},qe={class:"col-md-6 col-12"},De={class:"col-md-6 col-12 d-flex flex-column justify-content-between"},He={class:"fs-4 mb-4"},We={class:"mb-4"},Fe={key:0,class:"text-gray2 fs-5"},ze={key:1,class:"d-flex align-items-center"},Ge={class:"text-gray2 fs-5"},Ke={class:"text-brown fs-4 ms-3"},Je={class:"mb-5"},Qe=t("div",{class:"fs-6 mb-2"},"商品內容:",-1),Ze={class:"input-group w-100 mb-4"},et=["disabled"],tt={class:"d-flex justify-content-between mb-3"},st={class:"d-flex justify-content-center align-items-center me-2 mBtn"},ot={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},nt={class:"d-flex justify-content-center align-items-center mBtn"},at={class:"row mt-8"},it=t("div",{class:"fs-6 mb-4"},"商品詳情:",-1),rt={style:{"white-space":"pre-wrap"}},lt={class:"list-unstyled mb-3 col-12 col-md-7"},ct=["src"],dt={class:"container mt-8"},ut=t("h3",{class:"text-center text-brown"},[$(" 猜你喜歡 "),t("div",{class:"text-center text-brown m-0 p-0 fs-1"},"-")],-1),mt={id:"swiper"},pt={class:"row"},vt=["onClick"],_t={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown rounded-top"},ft=["src"],gt={class:"card-body"},bt={class:"card-title"},ht={key:0,class:"text-gray2 fs-5 card-title text-center"},yt={key:1,class:"d-flex justify-content-center align-items-center card-title ms-2"},wt={class:"text-gray2 fs-5"},xt={class:"text-brown fs-5 ms-3"},kt=t("br",null,null,-1),Ct=["onClick"],Tt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Pt=t("i",{class:"bi bi-cart-plus"},null,-1);function Mt(s,o,p,e,d,l){const m=E("VueLoading"),_=E("RouterLink"),u=E("ImageComponent"),v=E("swiper-slide"),c=E("swiper"),a=E("ToastMessages");return b(),y(j,null,[t("div",Ae,[L(m,{active:e.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:V(()=>[Be]),_:1},8,["active"]),t("div",je,[t("nav",Oe,[t("ol",Ne,[t("li",Xe,[L(_,{class:"text-black text-decoration-none",to:"/"},{default:V(()=>[$("首頁")]),_:1})]),t("li",Ye,[L(_,{class:"text-black text-decoration-none",to:"/products"},{default:V(()=>[$("產品")]),_:1})]),t("li",Re,k(e.product.category),1)])]),t("div",Ue,[t("div",qe,[L(u,{imageList:e.imagesUrl,class:"mb-8"},null,8,["imageList"])]),t("div",De,[t("div",He,k(e.product.title),1),t("div",We,[e.product.price===e.product.origin_price?(b(),y("div",Fe," $"+k(s.$filters.numberToCurrencyNo(e.product.origin_price)),1)):(b(),y("div",ze,[t("del",Ge,"$"+k(s.$filters.numberToCurrencyNo(e.product.origin_price)),1),t("div",Ke," $"+k(s.$filters.numberToCurrencyNo(e.product.price)),1)]))]),t("div",Je,[Qe,t("div",null,k(e.product.content),1)]),t("div",Ze,[t("button",{type:"button",class:"btn btn-outline-lightBrown",disabled:e.qty===1,onClick:o[0]||(o[0]=n=>e.qty--)}," - ",8,et),U(t("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>e.qty=n),type:"number",min:"1",max:"20",class:"form-control text-center","aria-label":"Dollar amount (with dot and two decimal places)",readonly:""},null,512),[[ne,e.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-outline-lightBrown",onClick:o[2]||(o[2]=n=>e.qty++)}," + ")]),t("div",tt,[t("div",st,[t("button",{type:"button",class:"loginbtn text-center bg-lightBrown border-0",onClick:o[3]||(o[3]=n=>e.addToCart(e.product.id))},[e.product.id===e.status.loadingItem?(b(),y("span",ot)):Y("",!0),$(" 加入購物車 ")])]),t("div",nt,[L(_,{class:"loginbtn text-center bg-brown",to:"/cart",onClick:o[4]||(o[4]=n=>e.addToCart(e.product.id))},{default:V(()=>[$("立即購買")]),_:1})])])])]),t("div",at,[it,t("div",rt,k(e.product.description),1)]),(b(!0),y(j,null,q(e.imagesUrl,n=>(b(),y("div",{class:"row mt-5",key:n},[t("li",lt,[t("img",{src:n,class:"w-100",alt:""},null,8,ct)])]))),128))])]),t("div",dt,[ut,t("div",mt,[L(c,{slidesPerView:e.slidesPerView,grabCursor:!0,spaceBetween:30,pagination:{clickable:!0},freeMode:!0,modules:e.modules,class:"mySwiper",mousewheel:!0,keyboard:!0},{default:V(()=>[(b(!0),y(j,null,q(e.products,n=>(b(),ae(v,{key:n.id},{default:V(()=>[t("div",pt,[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5 col-md-12 col-12 p-0",onClick:f=>e.openModal(n)},[n.price!==n.origin_price?(b(),y("span",_t,"SALE")):Y("",!0),t("img",{src:n.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"300px"},alt:"productPicture"},null,8,ft),t("div",gt,[t("p",bt,k(n.title),1),n.price===n.origin_price?(b(),y("div",ht," $"+k(s.$filters.numberToCurrencyNo(n.origin_price)),1)):(b(),y("div",yt,[t("del",wt,"$"+k(s.$filters.numberToCurrencyNo(n.origin_price)),1),t("div",xt," $"+k(s.$filters.numberToCurrencyNo(n.price)),1)])),kt,t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:ie(f=>e.addToCart(n.id,1),["stop"])},[n.id===e.status.loadingItem?(b(),y("span",Tt)):Y("",!0),Pt],8,Ct)])],8,vt)])]),_:2},1024))),128))]),_:1},8,["slidesPerView","modules"])])]),L(a)],64)}const jt=F($e,[["render",Mt]]);export{jt as default};
