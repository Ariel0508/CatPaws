import{a as V}from"./axios-G2rPRu76.js";import{_ as K,k as Q,l as W,g as l,s as X,h as Y,r as P,o as a,c as n,a as t,b as m,w as x,t as p,j as A,F as k,m as M,d as $,q as Z,p as tt,f as et}from"./index-8us_jk1W.js";import{u as st}from"./cartStore-PtuACJ6i.js";import{_ as ot}from"./PaginationComponent-FVGK8g0p.js";import{u as at}from"./toastMessage-FVCuufTk.js";import{_ as nt}from"./ToastMessages-OeisbGYM.js";import{_ as ct}from"./loading-bneA9sLj.js";var rt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"rubby-api",BASE_URL:"/week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:R,VITE_APP_PATH:D}=rt,it={setup(){const u=st(),{getCart:d}=u,N=at(),{pushMessage:s}=N,f=Q(),b=W(),w=l(b.params.productId),g=l([]),v=l({loadingItem:""}),h=l(!1),e=l([]),y=l(0),j=l(0),B=l(["時尚配件","休閒娛樂","生活用品"]),S=()=>{const{category:o=""}=b.query,r=`${R}/api/${D}/products?category=${o}`;V.get(r).then(i=>{g.value=i.data.products,L.value=i.data.pagination}).catch(i=>{alert(i.response.data.message)})},L=l({}),C=(o=1)=>{const{category:r=""}=b.query,i=`${R}/api/${D}/products?category=${r}&page=${o}`;h.value=!0,V.get(i).then(_=>{const I=_.data.products.slice();T.value==="high"?(I.sort((q,E)=>E.price-q.price),document.querySelector(".heightPrice").classList.add("activeC"),document.querySelector(".lowPrice").classList.remove("activeC")):T.value==="low"&&(I.sort((q,E)=>q.price-E.price),document.querySelector(".lowPrice").classList.add("activeC"),document.querySelector(".heightPrice").classList.remove("activeC")),g.value=I,L.value=_.data.pagination,h.value=!1}).catch(_=>{alert(_.response.data.message),h.value=!1})},T=l(""),U=o=>{T.value=o,C()},H=o=>{v.value.loadingItem=o;const r={product_id:o,qty:1},i=`${R}/api/${D}/cart`;V.post(i,{data:r}).then(_=>{v.value.loadingItem="",s({style:"success",title:"加入購物車",content:_.data.message}),d()})},O=o=>{f.push(`/product/${o.id}`).then(()=>{window.scrollTo(0,0)})},F=l(0),z=o=>{document.querySelectorAll(".activeCategory").forEach((i,_)=>{_===o?i.classList.add("activeC"):i.classList.remove("activeC")}),F.value=o},G=()=>{document.querySelectorAll(".activeCategory").forEach(r=>{r.classList.remove("activeC")})},J=o=>{const r=o.target.value;r==="全部產品"?f.push({path:"/products",query:{category:""}}):f.push(`/products?category=${r}`)};return X(()=>b.query,()=>{S(),C()}),Y(()=>{C(),S()}),{id:w,products:g,categories:B,status:v,isLoading:h,getProducts:S,sortProducts:U,addToCart:H,openModal:O,getData:C,pagination:L,carts:e,finalTotal:y,total:j,activeIndex:F,enterhandler:z,handleCategoryChange:J,handleAllProductsClick:G}},components:{Pagination:ot,ToastMessages:nt}},c=u=>(tt("data-v-32671aa1"),u=u(),et(),u),lt={id:"app"},dt=c(()=>t("img",{src:ct,width:"500",alt:"loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1)),ut={class:"container mt-7 p-0"},_t={"aria-label":"breadcrumb"},gt={class:"breadcrumb"},pt={class:"breadcrumb-item",to:"/"},ht=c(()=>t("li",{class:"breadcrumb-item active","aria-current":"page"},"產品",-1)),mt={key:0,class:"breadcrumb-item active","aria-current":"page"},bt={class:"row mt-5"},vt={class:"col-md-3"},yt={class:"mSale"},ft={class:"d-flex justify-content-end mb-3"},Ct=c(()=>t("option",{selected:""},"全部產品",-1)),Pt={class:"d-flex justify-content-end mb-5"},xt=c(()=>t("option",{selected:""},"價格",-1)),kt=c(()=>t("option",{value:"high"},"價格高到低",-1)),wt=c(()=>t("option",{value:"low"},"價格低到高",-1)),St=[xt,kt,wt],Lt={class:"pSale"},Tt={class:"list-unstyled mb-2"},It={class:"fs-4 text-gray2 mb-2 list-unstyled"},qt=c(()=>t("div",{class:"fs-4 text-gray2 mt-3 mb-2"},"篩選條件",-1)),Et=c(()=>t("span",{class:"heightPrice"},"價格高到低",-1)),Vt=[Et],At=c(()=>t("br",null,null,-1)),Mt=c(()=>t("span",{class:"lowPrice"},"價格低到高",-1)),$t=[Mt],Rt={class:"col-md-9"},Dt={class:"row"},Nt=["onClick"],jt={key:0,class:"position-absolute top-0 start-0 fw-bold text-white p-2 bg-brown"},Ft=["src"],Bt={class:"card-body"},Ut={class:"card-title text-center"},Ht={key:0,class:"text-gray2 fs-5 card-title text-center"},Ot={key:1,class:"d-flex justify-content-center align-items-center card-title ms-2"},zt={class:"text-gray2 fs-5"},Gt={class:"text-brown fs-5 ms-3"},Jt=c(()=>t("br",null,null,-1)),Kt=["onClick"],Qt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"},Wt=c(()=>t("i",{class:"bi bi-cart-plus"},null,-1)),Xt={class:"d-flex justify-content-end"};function Yt(u,d,N,s,f,b){const w=P("VueLoading"),g=P("RouterLink"),v=P("Pagination"),h=P("ToastMessages");return a(),n(k,null,[t("div",lt,[m(w,{active:s.isLoading,"is-full-page":!0,"background-color":"#FFF8F1",opacity:1,"z-index":1060},{default:x(()=>[dt]),_:1},8,["active"]),t("div",ut,[t("nav",_t,[t("ol",gt,[t("li",pt,[m(g,{class:"text-black text-decoration-none",to:"/"},{default:x(()=>[$("首頁")]),_:1})]),ht,s.pagination.category!==""?(a(),n("li",mt,p(s.pagination.category),1)):A("",!0)])]),t("div",bt,[t("div",vt,[t("div",yt,[t("div",ft,[t("select",{class:"p-1 text-center text-gray2 border-end-0 border-start-0 border-brown bg-vanilla w-100","aria-label":"Default select example",onChange:d[0]||(d[0]=(...e)=>s.handleCategoryChange&&s.handleCategoryChange(...e))},[Ct,(a(!0),n(k,null,M(s.categories,e=>(a(),n("option",{key:e},p(e),1))),128))],32)]),t("div",Pt,[t("select",{class:"p-1 text-gray2 border-end-0 border-start-0 border-top-0 border-bottom-1 border-brown bg-lightVanilla","aria-label":"Default select example",onChange:d[1]||(d[1]=e=>s.sortProducts(e.target.value))},St,32)])]),t("div",Lt,[t("ul",Tt,[t("li",It,[m(g,{class:"text-decoration-none text-gray2",to:{path:"/products",query:{category:""}},onClick:s.handleAllProductsClick},{default:x(()=>[$(" 全部產品 ")]),_:1},8,["onClick"])]),(a(!0),n(k,null,M(s.categories,(e,y)=>(a(),n("li",{key:e,class:"fs-6 mb-2 list-unstyled"},[m(g,{class:"activeCategory",to:`/products?category=${e}`,onClick:j=>s.enterhandler(y)},{default:x(()=>[$(p(e),1)]),_:2},1032,["to","onClick"])]))),128))]),qt,t("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:d[2]||(d[2]=e=>s.sortProducts("high"))},Vt),At,t("div",{class:"fs-6 text-gray2 mb-2 btn p-0 border-0",onClick:d[3]||(d[3]=e=>s.sortProducts("low"))},$t)])]),t("div",Rt,[t("div",Dt,[(a(!0),n(k,null,M(s.products,e=>(a(),n("div",{class:"col-md-4 col-6 mb-5",key:e.id},[t("div",{class:"card shadow-sm bg-body rounded-lg border-0 position-relative mb-5",onClick:y=>s.openModal(e)},[e.price!==e.origin_price?(a(),n("span",jt,"SALE")):A("",!0),t("img",{src:e.imageUrl,class:"card-img-top object-fit-cover w-100",style:{height:"280px"},alt:"productPicture"},null,8,Ft),t("div",Bt,[t("p",Ut,p(e.title),1),e.price===e.origin_price?(a(),n("div",Ht," $"+p(u.$filters.numberToCurrencyNo(e.origin_price)),1)):(a(),n("div",Ot,[t("del",zt,"$"+p(u.$filters.numberToCurrencyNo(e.origin_price)),1),t("div",Gt," $"+p(u.$filters.numberToCurrencyNo(e.price)),1)])),Jt,t("button",{type:"button",class:"btn btn-outline-brown border-0 fs-5 m-2 position-absolute bottom-0 end-0",onClick:Z(y=>s.addToCart(e.id,1),["stop"])},[e.id===s.status.loadingItem?(a(),n("span",Qt)):A("",!0),Wt],8,Kt)])],8,Nt)]))),128)),t("div",Xt,[m(v,{pages:s.pagination,onEmitPages:s.getData},null,8,["pages","onEmitPages"])])])])])])]),m(h)],64)}const ce=K(it,[["render",Yt],["__scopeId","data-v-32671aa1"]]);export{ce as default};
